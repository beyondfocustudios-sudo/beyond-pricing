"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6014],{15870:(e,a,l)=>{l.d(a,{A:()=>s});let s=(0,l(71847).A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},26041:(e,a,l)=>{l.d(a,{BU:()=>i,V:()=>r,dx:()=>c,iJ:()=>t,qd:()=>n,vj:()=>s});let s=[{value:"crew",label:"Equipa (Crew)",color:"#1a8fa3"},{value:"equipamento",label:"Equipamento",color:"#8b6b56"},{value:"pos_producao",label:"P\xf3s-Produ\xe7\xe3o",color:"#7c3aed"},{value:"despesas",label:"Despesas",color:"#d97706"},{value:"outro",label:"Outro",color:"#5a6280"}],t=[{value:"continental_23",label:"Continental (23%)",rate:23},{value:"madeira_22",label:"Madeira (22%)",rate:22},{value:"acores_16",label:"A\xe7ores (16%)",rate:16},{value:"isento",label:"Isento / Art. 53.\xba (0%)",rate:0}];function r(e){var a,l;return null!=(l=null==(a=t.find(a=>a.value===e))?void 0:a.rate)?l:23}let i=[{value:"rascunho",label:"Rascunho",badge:"badge-default"},{value:"enviado",label:"Enviado",badge:"badge-accent"},{value:"aprovado",label:"Aprovado",badge:"badge-success"},{value:"cancelado",label:"Cancelado",badge:"badge-error"},{value:"arquivado",label:"Arquivado",badge:"badge-warning"}],n=[{value:"pre_producao",label:"Pr\xe9-Produ\xe7\xe3o",color:"#1a8fa3"},{value:"rodagem",label:"Rodagem",color:"#d97706"},{value:"pos_producao",label:"P\xf3s-Produ\xe7\xe3o",color:"#7c3aed"}],c={iva_regime:"continental_23",overhead_pct:15,contingencia_pct:10,margem_alvo_pct:30,margem_minima_pct:15,investimento_pct:0,moeda:"EUR"}},36014:(e,a,l)=>{l.r(a),l.d(a,{default:()=>m});var s=l(95155),t=l(12115),r=l(69434),i=l(62890),n=l(26041),c=l(15870),d=l(46046),o=l(95740);function m(){let[e,a]=(0,t.useState)({...n.dx}),[l,m]=(0,t.useState)(!0),[u,v]=(0,t.useState)(!1),[p,g]=(0,t.useState)(!1),[x,h]=(0,t.useState)("");(0,t.useEffect)(()=>{(async()=>{let e=(0,i.U)(),{data:{user:l}}=await e.auth.getUser();if(!l)return;let{data:s}=await e.from("preferences").select("*").eq("user_id",l.id).single();if(s){var t,r,c,d,o,u,v,p;a({iva_regime:null!=(t=s.iva_regime)?t:n.dx.iva_regime,overhead_pct:null!=(r=s.overhead_pct)?r:n.dx.overhead_pct,contingencia_pct:null!=(c=s.contingencia_pct)?c:n.dx.contingencia_pct,margem_alvo_pct:null!=(d=s.margem_alvo_pct)?d:n.dx.margem_alvo_pct,margem_minima_pct:null!=(o=s.margem_minima_pct)?o:n.dx.margem_minima_pct,investimento_pct:null!=(u=s.investimento_pct)?u:n.dx.investimento_pct,moeda:null!=(v=s.moeda)?v:n.dx.moeda,ai_tagging_enabled:null!=(p=s.ai_tagging_enabled)&&p})}m(!1)})()},[]);let b=async()=>{v(!0),h("");let a=(0,i.U)(),{data:{user:l}}=await a.auth.getUser();if(!l)return;let{error:s}=await a.from("preferences").upsert({user_id:l.id,...e,updated_at:new Date().toISOString()},{onConflict:"user_id"});if(v(!1),s)return void h(s.message);g(!0),setTimeout(()=>g(!1),2500)},_=function(l,t,r,i){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"%";return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("label",{className:"label",style:{marginBottom:0},children:l}),(0,s.jsxs)("span",{className:"text-sm font-semibold",style:{color:"var(--accent-2)"},children:[e[t],c]})]}),(0,s.jsx)("input",{type:"range",min:r,max:i,step:n,value:Number(e[t]),onChange:l=>a({...e,[t]:parseFloat(l.target.value)}),className:"slider"}),(0,s.jsxs)("div",{className:"flex justify-between mt-1",children:[(0,s.jsxs)("span",{className:"text-xs",style:{color:"var(--text-3)"},children:[r,c]}),(0,s.jsxs)("span",{className:"text-xs",style:{color:"var(--text-3)"},children:[i,c]})]})]})};return l?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"page-header",children:(0,s.jsx)("h1",{className:"page-title",children:"Prefer\xeancias"})}),(0,s.jsx)("div",{className:"card space-y-4",children:Array.from({length:5}).map((e,a)=>(0,s.jsx)("div",{className:"skeleton h-12 w-full rounded-lg"},a))})]}):(0,s.jsxs)(r.P.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"space-y-6 max-w-xl",children:[(0,s.jsxs)("div",{className:"page-header",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"page-title",children:"Prefer\xeancias"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Defaults para novos projetos"})]}),(0,s.jsx)(c.A,{className:"h-5 w-5",style:{color:"var(--text-3)"}})]}),(0,s.jsxs)("div",{className:"card space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Regime de IVA padr\xe3o"}),(0,s.jsx)("select",{value:e.iva_regime,onChange:l=>a({...e,iva_regime:l.target.value}),className:"input",children:n.iJ.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsx)("hr",{className:"divider"}),_("Overhead","overhead_pct",0,50),_("Conting\xeancia","contingencia_pct",0,30),_("Margem Alvo","margem_alvo_pct",0,60),_("Margem M\xednima","margem_minima_pct",0,40),_("Investimento","investimento_pct",0,20),x&&(0,s.jsx)("div",{className:"alert alert-error",children:x}),p&&(0,s.jsx)("div",{className:"alert alert-success",children:"Prefer\xeancias guardadas com sucesso!"}),(0,s.jsxs)("button",{onClick:b,disabled:u,className:"btn btn-primary w-full",children:[(0,s.jsx)(d.A,{className:"h-4 w-4"}),u?"A guardar…":"Guardar Prefer\xeancias"]})]}),(0,s.jsxs)("div",{className:"card space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)(o.A,{className:"h-4 w-4",style:{color:"#7c3aed"}}),(0,s.jsx)("p",{className:"text-sm font-semibold",style:{color:"var(--text)"},children:"Funcionalidades Experimentais"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-xl p-4",style:{background:"var(--surface-2)"},children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("p",{className:"text-sm font-medium",style:{color:"var(--text)"},children:["AI Tagging ",(0,s.jsx)("span",{className:"text-xs px-1.5 py-0.5 rounded ml-1",style:{background:"rgba(124,58,237,0.15)",color:"#7c3aed"},children:"beta"})]}),(0,s.jsx)("p",{className:"text-xs mt-0.5",style:{color:"var(--text-3)"},children:"Analisa fotos com OpenAI Vision para adicionar tags autom\xe1ticas. Requer OPENAI_API_KEY no servidor. Desligado por omiss\xe3o."})]}),(0,s.jsx)("button",{onClick:()=>a(e=>({...e,ai_tagging_enabled:!e.ai_tagging_enabled})),className:"ml-4 relative inline-flex h-6 w-11 items-center rounded-full transition-colors shrink-0",style:{background:e.ai_tagging_enabled?"#7c3aed":"var(--surface-3)"},children:(0,s.jsx)("span",{className:"inline-block h-4 w-4 rounded-full bg-white shadow transition-transform",style:{transform:e.ai_tagging_enabled?"translateX(22px)":"translateX(2px)"}})})]}),(0,s.jsx)("p",{className:"text-xs",style:{color:"var(--text-3)"},children:"Tags guardadas em metadata.tags — ficheiros Dropbox nunca s\xe3o renomeados."})]})]})}},46046:(e,a,l)=>{l.d(a,{A:()=>s});let s=(0,l(71847).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},62890:(e,a,l)=>{l.d(a,{U:()=>t});var s=l(55417);function t(){return(0,s.createBrowserClient)("https://wjzcutnjnzxylzqysneg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndqemN1dG5qbnp4eWx6cXlzbmVnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzMjYzMjcsImV4cCI6MjA4NjkwMjMyN30.bku3F43nks_Uq22Ag-viZZpMQfrw43eq3sahNChbBq8")}},95740:(e,a,l)=>{l.d(a,{A:()=>s});let s=(0,l(71847).A)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])}}]);