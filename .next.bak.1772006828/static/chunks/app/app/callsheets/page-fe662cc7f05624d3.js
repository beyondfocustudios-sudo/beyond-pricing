(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[39],{6191:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},12108:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},16485:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},21873:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},23220:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var a=s(95155),l=s(12115),n=s(35299),r=s(6191),i=s(65229),c=s(89715),o=s(16485),d=s(26983),m=s(21873),h=s(71360),p=s(12108),x=s(24033),u=s(91169),v=s(69141);function y(){let[e,t]=(0,l.useState)([]),[s,y]=(0,l.useState)(!0),[j,N]=(0,l.useState)(null),[g,f]=(0,l.useState)(!1),[b,k]=(0,l.useState)(null),[_,w]=(0,l.useState)({title:"",shoot_date:"",location_name:"",location_address:"",general_call_time:"08:00",notes:""}),[A,C]=(0,l.useState)([{name:"",role:"",department:"",phone:"",call_time:""}]),[M,S]=(0,l.useState)([{title:"",start_time:"08:00",end_time:"",department:""}]),[E,T]=(0,l.useState)(!1),z=(0,l.useCallback)(async()=>{N(null);let e=await fetch("/api/callsheets");if(e.ok)t(await e.json());else{var s;N(null!=(s=(await e.json().catch(()=>({}))).error)?s:"Erro ao carregar call sheets")}y(!1)},[]);(0,l.useEffect)(()=>{z()},[z]);let q=async e=>{if(b===e)return void k(null);let s=await fetch("/api/callsheets?id=".concat(e));if(s.ok){let a=await s.json();t(t=>t.map(t=>t.id===e?{...t,...a}:t))}k(e)},L=async()=>{_.title.trim()&&!E&&(T(!0),await fetch("/api/callsheets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({..._,people:A.filter(e=>e.name.trim()),schedule:M.filter(e=>e.title.trim())})}),T(!1),f(!1),w({title:"",shoot_date:"",location_name:"",location_address:"",general_call_time:"08:00",notes:""}),C([{name:"",role:"",department:"",phone:"",call_time:""}]),S([{title:"",start_time:"08:00",end_time:"",department:""}]),z())},P=async e=>{confirm("Eliminar esta call sheet?")&&(await fetch("/api/callsheets?id=".concat(e),{method:"DELETE"}),t(t=>t.filter(t=>t.id!==e)))},H=(e,t,s)=>C(a=>a.map((a,l)=>l===e?{...a,[t]:s}:a)),O=(e,t,s)=>S(a=>a.map((a,l)=>l===e?{...a,[t]:s}:a));return s?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsx)(n.A,{className:"w-6 h-6 animate-spin",style:{color:"var(--text-3)"}})}):j?(0,a.jsxs)("div",{className:"card text-center space-y-3",children:[(0,a.jsx)("p",{style:{color:"var(--text-2)"},children:j}),(0,a.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:z,children:"Tentar novamente"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"page-title",children:"Call Sheets"}),(0,a.jsxs)("p",{className:"page-subtitle",children:[e.length," call sheet",1!==e.length?"s":""]})]}),(0,a.jsxs)("button",{onClick:()=>f(e=>!e),className:"btn btn-primary btn-sm",children:[(0,a.jsx)(r.A,{className:"w-4 h-4"}),"Nova Call Sheet"]})]}),g&&(0,a.jsxs)("div",{className:"card space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-base font-semibold",style:{color:"var(--text)"},children:"Nova Call Sheet"}),(0,a.jsx)("button",{onClick:()=>f(!1),className:"btn btn-ghost btn-icon-sm",children:(0,a.jsx)(i.A,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsx)("input",{value:_.title,onChange:e=>w(t=>({...t,title:e.target.value})),placeholder:"T\xedtulo *",className:"input col-span-full"}),(0,a.jsx)("input",{type:"date",value:_.shoot_date,onChange:e=>w(t=>({...t,shoot_date:e.target.value})),className:"input"}),(0,a.jsx)("input",{type:"time",value:_.general_call_time,onChange:e=>w(t=>({...t,general_call_time:e.target.value})),className:"input"}),(0,a.jsx)("input",{value:_.location_name,onChange:e=>w(t=>({...t,location_name:e.target.value})),placeholder:"Nome do local",className:"input"}),(0,a.jsx)("input",{value:_.location_address,onChange:e=>w(t=>({...t,location_address:e.target.value})),placeholder:"Morada",className:"input"}),(0,a.jsx)("textarea",{value:_.notes,onChange:e=>w(t=>({...t,notes:e.target.value})),placeholder:"Notas gerais",rows:2,className:"input col-span-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"section-title",children:"Equipa"}),(0,a.jsxs)("button",{onClick:()=>C(e=>[...e,{name:"",role:"",department:"",phone:"",call_time:""}]),className:"btn btn-ghost btn-sm",style:{fontSize:"0.75rem"},children:[(0,a.jsx)(r.A,{className:"w-3 h-3"})," Adicionar"]})]}),A.map((e,t)=>{var s;return(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 mb-2 items-center",children:[(0,a.jsx)("input",{value:e.name,onChange:e=>H(t,"name",e.target.value),placeholder:"Nome",className:"input input-sm col-span-2"}),(0,a.jsx)("input",{value:e.role,onChange:e=>H(t,"role",e.target.value),placeholder:"Fun\xe7\xe3o",className:"input input-sm"}),(0,a.jsx)("input",{type:"time",value:null!=(s=e.call_time)?s:"",onChange:e=>H(t,"call_time",e.target.value),className:"input input-sm"}),(0,a.jsx)("button",{onClick:()=>C(e=>e.filter((e,s)=>s!==t)),className:"btn btn-ghost btn-icon-sm justify-self-center",style:{color:"var(--error)"},children:(0,a.jsx)(i.A,{className:"w-3.5 h-3.5"})})]},t)})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"section-title",children:"Scaletta"}),(0,a.jsxs)("button",{onClick:()=>S(e=>[...e,{title:"",start_time:"09:00",end_time:"",department:""}]),className:"btn btn-ghost btn-sm",style:{fontSize:"0.75rem"},children:[(0,a.jsx)(r.A,{className:"w-3 h-3"})," Adicionar"]})]}),M.map((e,t)=>{var s;return(0,a.jsxs)("div",{className:"grid grid-cols-5 gap-2 mb-2 items-center",children:[(0,a.jsx)("input",{value:e.title,onChange:e=>O(t,"title",e.target.value),placeholder:"Atividade",className:"input input-sm col-span-2"}),(0,a.jsx)("input",{type:"time",value:e.start_time,onChange:e=>O(t,"start_time",e.target.value),className:"input input-sm"}),(0,a.jsx)("input",{type:"time",value:null!=(s=e.end_time)?s:"",onChange:e=>O(t,"end_time",e.target.value),className:"input input-sm"}),(0,a.jsx)("button",{onClick:()=>S(e=>e.filter((e,s)=>s!==t)),className:"btn btn-ghost btn-icon-sm justify-self-center",style:{color:"var(--error)"},children:(0,a.jsx)(i.A,{className:"w-3.5 h-3.5"})})]},t)})]}),(0,a.jsx)("button",{onClick:L,disabled:E||!_.title.trim(),className:"btn btn-primary w-full",children:E?"A criarâ€¦":"Criar Call Sheet"})]}),0===e.length?(0,a.jsxs)("div",{className:"empty-state",children:[(0,a.jsx)(c.A,{className:"empty-icon"}),(0,a.jsx)("p",{className:"empty-title",children:"Nenhuma call sheet ainda."})]}):(0,a.jsx)("div",{className:"space-y-3",children:e.map(e=>{var t,s,l,n,r,i;return(0,a.jsxs)("div",{className:"card",style:{padding:0,overflow:"hidden"},children:[(0,a.jsxs)("button",{onClick:()=>q(e.id),className:"w-full flex items-center gap-4 px-5 py-4 text-left transition-colors",style:{background:"transparent"},onMouseEnter:e=>e.currentTarget.style.background="var(--surface-2)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm",style:{color:"var(--text)"},children:e.title}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-1 flex-wrap",style:{color:"var(--text-3)"},children:[e.shoot_date&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-xs",children:[(0,a.jsx)(o.A,{className:"w-3 h-3"}),new Date(e.shoot_date).toLocaleDateString("pt-PT",{weekday:"short",day:"2-digit",month:"short"})]}),e.general_call_time&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-xs",children:[(0,a.jsx)(d.A,{className:"w-3 h-3"}),"Call: ",e.general_call_time]}),e.location_name&&(0,a.jsxs)("span",{className:"flex items-center gap-1 text-xs",children:[(0,a.jsx)(m.A,{className:"w-3 h-3"}),e.location_name]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),P(e.id)},className:"btn btn-ghost btn-icon-sm",style:{color:"var(--error)"},children:(0,a.jsx)(h.A,{className:"w-3.5 h-3.5"})}),b===e.id?(0,a.jsx)(p.A,{className:"w-4 h-4",style:{color:"var(--text-3)"}}):(0,a.jsx)(x.A,{className:"w-4 h-4",style:{color:"var(--text-3)"}})]})]}),b===e.id&&(0,a.jsxs)("div",{className:"px-5 pb-5 space-y-4 pt-4",style:{borderTop:"1px solid var(--border)"},children:[e.notes&&(0,a.jsx)("p",{className:"text-sm",style:{color:"var(--text-2)"},children:e.notes}),(null!=(r=null==(t=e.call_sheet_people)?void 0:t.length)?r:0)>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"section-title mb-2 flex items-center gap-1.5",children:[(0,a.jsx)(u.A,{className:"w-3.5 h-3.5"})," Equipa"]}),(0,a.jsx)("div",{className:"space-y-1.5",children:null==(s=e.call_sheet_people)?void 0:s.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm rounded-xl px-3 py-2",style:{background:"var(--surface-2)"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",style:{color:"var(--text)"},children:e.name}),e.role&&(0,a.jsx)("span",{className:"ml-2 text-xs",style:{color:"var(--text-3)"},children:e.role}),e.department&&(0,a.jsxs)("span",{className:"ml-2 text-xs",style:{color:"var(--text-3)"},children:["\xb7 ",e.department]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-xs",style:{color:"var(--text-3)"},children:[e.call_time&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(d.A,{className:"w-3 h-3"}),e.call_time]}),e.phone&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(v.A,{className:"w-3 h-3"}),e.phone]})]})]},t))})]}),(null!=(i=null==(l=e.call_sheet_schedule)?void 0:l.length)?i:0)>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"section-title mb-2",children:"Scaletta"}),(0,a.jsx)("div",{className:"space-y-1.5",children:null==(n=e.call_sheet_schedule)?void 0:n.sort((e,t)=>e.start_time.localeCompare(t.start_time)).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm rounded-xl px-3 py-2",style:{background:"var(--surface-2)"},children:[(0,a.jsx)("span",{className:"text-xs w-12 shrink-0",style:{color:"var(--text-3)"},children:e.start_time}),(0,a.jsx)("span",{className:"flex-1",style:{color:"var(--text)"},children:e.title}),e.end_time&&(0,a.jsx)("span",{className:"text-xs",style:{color:"var(--text-3)"},children:e.end_time})]},t))})]})]})]},e.id)})})]})}},24033:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},26983:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},33256:(e,t,s)=>{Promise.resolve().then(s.bind(s,23220))},35299:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},65229:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},69141:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},71360:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},71847:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(12115);let l=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let r=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:o="",children:d,iconNode:m,...h}=e;return(0,a.createElement)("svg",{ref:t,...n,width:r,height:r,stroke:s,strokeWidth:c?24*Number(i)/Number(r):i,className:l("lucide",o),...h},[...m.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let s=(0,a.forwardRef)((s,n)=>{let{className:i,...c}=s;return(0,a.createElement)(r,{ref:n,iconNode:t,className:l("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),i),...c})});return s.displayName="".concat(e),s}},89715:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},91169:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=33256)),_N_E=e.O()}]);