(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9959],{6132:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6191:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},16485:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},18098:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]])},24589:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]])},35299:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},39142:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]])},45635:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var a=r(95155),s=r(12115),n=r(35299),l=r(39142),i=r(6191),o=r(65229);let c=(0,r(71847).A)("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);var d=r(24589),u=r(16485),p=r(6132),x=r(18098);let m=["pt-PT","pt-BR","en-US"];function h(){var e;let t=window,r=null!=(e=t.SpeechRecognition)?e:t.webkitSpeechRecognition;return null!=r?r:null}function v(e){let{onInsert:t,lang:r="pt-PT",className:n=""}=e,{isSupported:i,isRecording:o,transcript:c,interimTranscript:d,error:u,toggle:v,clear:y}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{lang:t="pt-PT",continuous:r=!0,interimResults:a=!0,onTranscript:n}=e,[l,i]=(0,s.useState)({isSupported:!1,isRecording:!1,transcript:"",interimTranscript:"",error:null}),o=(0,s.useRef)(null),c=(0,s.useRef)(0),d=(0,s.useRef)(!1),u=(0,s.useRef)(n);(0,s.useEffect)(()=>{u.current=n},[n]),(0,s.useEffect)(()=>{let e=null!==h();i(t=>({...t,isSupported:e}))},[]);let p=(0,s.useCallback)(e=>{var s,n;let l=h();if(!l)return null;let x=null!=(s=null!=e?e:m[c.current])?s:t,v=function(e,t,r,a){let s=new e;return s.lang=t,s.continuous=r,s.interimResults=a,s}(l,x,r,a);return v.onresult=e=>{var t,r,a;let s=null!=(t=e.resultIndex)?t:0,n=e.results,l="",o="";for(let e=s;e<n.length;e++){let t=n[e],s=t.isFinal,i=null!=(a=null==(r=t[0])?void 0:r.transcript)?a:"";s?o+=i:l+=i}i(e=>{let t=e.transcript+(o?(e.transcript?" ":"")+o:"");return o&&u.current&&u.current(t),{...e,transcript:t,interimTranscript:l,error:null}})},n=e=>{var t;let r=null!=(t=e.error)?t:"unknown";if("language-not-supported"===r||"no-speech"===r){c.current=(c.current+1)%m.length;let e=m[c.current];if(e&&e!==x){v.stop(),setTimeout(()=>{let t=p(e);t&&(o.current=t,t.start())},300);return}}i(e=>{var t,a;return{...e,isRecording:!1,error:null!=(a=({"no-speech":"Nenhuma fala detectada. Tenta novamente.",aborted:"Ditado cancelado.","audio-capture":"Microfone n\xe3o encontrado. Verifica as permiss\xf5es.",network:"Erro de rede no reconhecimento de voz.","not-allowed":"Permiss\xe3o do microfone negada.","service-not-allowed":"Servi\xe7o de voz n\xe3o dispon\xedvel.","language-not-supported":"Idioma n\xe3o suportado. A tentar alternativa…","bad-grammar":"Gram\xe1tica inv\xe1lida."})[t=r])?a:"Erro de ditado: ".concat(t)}})},v.onerror=n,v.onend=()=>{d.current=!1,i(e=>({...e,isRecording:!1,interimTranscript:""}))},v},[r,a,t]);(0,s.useEffect)(()=>()=>{if(o.current){try{o.current.stop()}catch(e){}o.current=null}},[]);let x=(0,s.useCallback)(()=>{if(d.current)return;d.current=!0,c.current=m.indexOf(t)>=0?m.indexOf(t):0;let e=p();if(!e){i(e=>({...e,error:"Browser n\xe3o suporta ditado por voz.",isRecording:!1})),d.current=!1;return}o.current=e,i(e=>({...e,isRecording:!0,error:null}));try{e.start()}catch(e){d.current=!1}},[p,t]),v=(0,s.useCallback)(()=>{if(o.current)try{o.current.stop()}catch(e){}d.current=!1,i(e=>({...e,isRecording:!1,interimTranscript:""}))},[]),y=(0,s.useCallback)(()=>{l.isRecording?v():x()},[l.isRecording,x,v]),f=(0,s.useCallback)(()=>{i(e=>({...e,transcript:"",interimTranscript:""}))},[]);return{...l,start:x,stop:v,toggle:y,clear:f}}({lang:r}),f=(0,s.useRef)(null);if((0,s.useEffect)(()=>{let e=f.current;return()=>{null==e||e()}},[]),!i)return(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-xs px-3 py-1.5 rounded-lg ".concat(n),style:{background:"rgba(245,158,11,0.1)",color:"#f59e0b",border:"1px solid rgba(245,158,11,0.2)"},children:[(0,a.jsx)(p.A,{className:"h-3.5 w-3.5 shrink-0"}),(0,a.jsx)("span",{children:"Ditado n\xe3o dispon\xedvel — usa Chrome ou Edge"})]});let g=c.trim().length>0||d.trim().length>0;return(0,a.jsxs)("div",{className:"flex flex-col gap-2 ".concat(n),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:v,title:o?"Parar ditado":"Iniciar ditado por voz (gr\xe1tis — requer Chrome/Edge)",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium transition-all select-none",style:{background:o?"rgba(239,68,68,0.15)":"rgba(26,143,163,0.12)",color:o?"#ef4444":"var(--accent, #1a8fa3)",border:"1px solid ".concat(o?"rgba(239,68,68,0.3)":"rgba(26,143,163,0.25)"),boxShadow:o?"0 0 0 2px rgba(239,68,68,0.15)":"none"},children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"relative flex h-3.5 w-3.5",children:[(0,a.jsx)("span",{className:"absolute inline-flex h-full w-full rounded-full opacity-75",style:{background:"#ef4444",animation:"ping 1s cubic-bezier(0,0,0.2,1) infinite"}}),(0,a.jsx)(x.A,{className:"relative h-3.5 w-3.5"})]}),"A gravar…"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A,{className:"h-3.5 w-3.5"}),"Ditado"]})}),g&&!o&&(0,a.jsx)("button",{type:"button",onClick:()=>{c.trim()&&(t(c.trim()),y())},className:"px-3 py-1.5 rounded-lg text-xs font-semibold transition-all",style:{background:"var(--accent, #1a8fa3)",color:"white"},children:"Inserir"}),g&&(0,a.jsx)("button",{type:"button",onClick:y,className:"px-2 py-1.5 rounded-lg text-xs transition-all",style:{color:"var(--text-3, #8b98b0)"},children:"Limpar"})]}),(g||o)&&(0,a.jsxs)("div",{className:"text-xs px-3 py-2 rounded-lg min-h-[2rem]",style:{background:"var(--surface-2, rgba(13,17,27,0.6))",border:"1px solid var(--border, rgba(30,39,54,0.8))",color:"var(--text, #f0f4f8)",lineHeight:1.5},children:[c,d&&(0,a.jsxs)("span",{style:{color:"var(--text-3, #8b98b0)"},children:[" ",d]}),o&&!g&&(0,a.jsx)("span",{style:{color:"var(--text-3, #8b98b0)"},children:"A ouvir…"})]}),u&&(0,a.jsxs)("p",{className:"text-xs flex items-center gap-1",style:{color:"#f87171"},children:[(0,a.jsx)(p.A,{className:"h-3 w-3 shrink-0"}),u]})]})}let y=[{id:"todo",label:"A fazer"},{id:"in_progress",label:"Em curso"},{id:"done",label:"Conclu\xeddo"}],f={low:"var(--text-3)",medium:"var(--warning)",high:"#f97316",urgent:"var(--error)"},g={low:"Baixa",medium:"M\xe9dia",high:"Alta",urgent:"Urgente"};function b(){let[e,t]=(0,s.useState)([]),[r,p]=(0,s.useState)(!0),[x,m]=(0,s.useState)(null),[h,b]=(0,s.useState)(null),[j,k]=(0,s.useState)({title:"",description:"",priority:"medium",due_date:""}),[N,w]=(0,s.useState)(!1),[A,C]=(0,s.useState)(!1),[S,T]=(0,s.useState)(""),[E,M]=(0,s.useState)(!1),[R,_]=(0,s.useState)(null),[O,D]=(0,s.useState)(null),[P,z]=(0,s.useState)({}),L=s.useRef({}),F=(0,s.useCallback)(async()=>{var e,r;m(null);let a=await fetch("/api/tasks?limit=200");a.ok?t(null!=(e=(await a.json()).tasks)?e:[]):m(null!=(r=(await a.json().catch(()=>({}))).error)?r:"Erro ao carregar tarefas"),p(!1)},[]);(0,s.useEffect)(()=>{F()},[F]);let I=async()=>{if(!j.title.trim()||N)return;w(!0);let t=e.filter(e=>e.status===(null!=h?h:"todo"));await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:j.title,description:j.description,status:null!=h?h:"todo",priority:j.priority,due_date:j.due_date||null,position:t.length})}),k({title:"",description:"",priority:"medium",due_date:""}),b(null),w(!1),F()},V=async(e,r)=>{t(t=>t.map(t=>t.id===e?{...t,status:r}:t)),await fetch("/api/tasks",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,status:r})})},X=async e=>{t(t=>t.filter(t=>t.id!==e)),await fetch("/api/tasks?id=".concat(e),{method:"DELETE"})},B=async()=>{if(!S.trim()||E)return;M(!0);let e=await fetch("/api/tasks/from-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:S})});if(e.ok){let{tasks:r}=await e.json();for(let e of r){var t;await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e.title,status:"todo",priority:null!=(t=e.priority)?t:"medium",position:0})})}T(""),C(!1),F()}M(!1)};return r?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsx)(n.A,{className:"w-6 h-6 animate-spin",style:{color:"var(--text-3)"}})}):x?(0,a.jsxs)("div",{className:"card text-center space-y-3",children:[(0,a.jsx)("p",{style:{color:"var(--text-2)"},children:x}),(0,a.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:F,children:"Tentar novamente"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"page-title",children:"Tarefas"}),(0,a.jsxs)("p",{className:"page-subtitle",children:[e.length," tarefa",1!==e.length?"s":""]})]}),(0,a.jsxs)("button",{onClick:()=>C(e=>!e),className:"btn btn-secondary btn-sm",children:[(0,a.jsx)(l.A,{className:"w-4 h-4"}),"Ditar tarefas"]})]}),A&&(0,a.jsxs)("div",{className:"card space-y-3",children:[(0,a.jsx)("p",{className:"text-sm",style:{color:"var(--text-2)"},children:"Dita ou escreve as tuas tarefas — uma por linha."}),(0,a.jsx)(v,{onInsert:e=>T(t=>t?t+" "+e:e)}),(0,a.jsx)("textarea",{value:S,onChange:e=>T(e.target.value),placeholder:"Exemplo: Editar v\xeddeo de Lisboa\nEnviar or\xe7amento ao cliente\nPreparar call sheet",rows:4,className:"input w-full"}),(0,a.jsx)("button",{onClick:B,disabled:E||!S.trim(),className:"btn btn-primary btn-sm",children:E?"A processar…":"Criar tarefas"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:y.map(t=>{let r=e.filter(e=>e.status===t.id).sort((e,t)=>e.position-t.position),s="in_progress"===t.id?"var(--pastel-blue)":"done"===t.id?"var(--pastel-green)":"var(--surface-2)",n="in_progress"===t.id?"var(--pastel-blue-border)":"done"===t.id?"var(--pastel-green-border)":"var(--border)";return(0,a.jsxs)("div",{onDragOver:e=>{var r;return r=t.id,void(e.preventDefault(),D(r))},onDrop:e=>{var r;return r=t.id,void(e.preventDefault(),R&&V(R,r),_(null),D(null))},style:{background:s,border:"1px solid ".concat(n),borderRadius:"var(--r-xl)",padding:"1rem",minHeight:"18rem",transition:"box-shadow 0.15s",boxShadow:O===t.id?"0 0 0 2px var(--accent)":void 0},children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold",style:{color:"var(--text)"},children:t.label}),(0,a.jsx)("span",{className:"text-xs rounded-full px-2 py-0.5",style:{background:"var(--surface)",color:"var(--text-3)"},children:r.length})]}),(0,a.jsx)("button",{onClick:()=>b(t.id),className:"btn btn-ghost btn-icon-sm",children:(0,a.jsx)(i.A,{className:"w-4 h-4"})})]}),h===t.id&&(0,a.jsxs)("div",{className:"mb-3 rounded-xl p-3 space-y-2",style:{background:"var(--surface)",border:"1px solid var(--border-2)"},children:[(0,a.jsx)("input",{autoFocus:!0,value:j.title,onChange:e=>k(t=>({...t,title:e.target.value})),onKeyDown:e=>{"Enter"===e.key&&I(),"Escape"===e.key&&b(null)},placeholder:"T\xedtulo da tarefa…",className:"w-full bg-transparent text-sm focus:outline-none",style:{color:"var(--text)"}}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("select",{value:j.priority,onChange:e=>k(t=>({...t,priority:e.target.value})),className:"input input-sm flex-1",children:Object.entries(g).map(e=>{let[t,r]=e;return(0,a.jsx)("option",{value:t,children:r},t)})}),(0,a.jsx)("input",{type:"date",value:j.due_date,onChange:e=>k(t=>({...t,due_date:e.target.value})),className:"input input-sm flex-1"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:I,disabled:N,className:"btn btn-primary btn-sm flex-1",children:N?"…":"Adicionar"}),(0,a.jsx)("button",{onClick:()=>b(null),className:"btn btn-ghost btn-icon-sm",children:(0,a.jsx)(o.A,{className:"w-3.5 h-3.5"})})]})]}),(0,a.jsx)("div",{className:"space-y-2",children:r.map(e=>{var t;return(0,a.jsxs)("div",{className:"relative overflow-hidden rounded-xl",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center justify-center w-20 rounded-r-xl",style:{background:"var(--error)"},"aria-hidden":"true",children:(0,a.jsx)(o.A,{className:"w-5 h-5 text-white"})}),(0,a.jsx)("div",{draggable:!0,onDragStart:t=>{_(e.id),t.dataTransfer.effectAllowed="move"},onTouchStart:t=>{var r;return r=e.id,void(L.current[r]=t.touches[0].clientX)},onTouchMove:t=>((e,t)=>{var r;let a=t.touches[0].clientX-(null!=(r=L.current[e])?r:t.touches[0].clientX);a<0&&z(t=>({...t,[e]:Math.max(a,-80)}))})(e.id,t),onTouchEnd:()=>{var t,r;(null!=(r=P[t=e.id])?r:0)<=-60&&X(t),z(e=>({...e,[t]:0}))},style:{transform:"translateX(".concat(null!=(t=P[e.id])?t:0,"px)"),transition:P[e.id]?"none":"transform 0.2s ease",background:"var(--surface)",border:"1px solid var(--border)",borderRadius:"var(--r-lg)",opacity:R===e.id?.4:1},className:"group relative p-3 cursor-grab active:cursor-grabbing transition-colors",onMouseEnter:e=>e.currentTarget.style.borderColor="var(--border-2)",onMouseLeave:e=>e.currentTarget.style.borderColor="var(--border)",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(c,{className:"w-3.5 h-3.5 mt-0.5 shrink-0",style:{color:"var(--text-3)"}}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm leading-snug",style:{color:"var(--text)"},children:e.title}),e.description&&(0,a.jsx)("p",{className:"text-xs mt-0.5 line-clamp-2",style:{color:"var(--text-3)"},children:e.description}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[(0,a.jsxs)("span",{className:"text-xs flex items-center gap-0.5",style:{color:f[e.priority]},children:[(0,a.jsx)(d.A,{className:"w-3 h-3"}),g[e.priority]]}),e.due_date&&(0,a.jsxs)("span",{className:"text-xs flex items-center gap-0.5",style:{color:"var(--text-3)"},children:[(0,a.jsx)(u.A,{className:"w-3 h-3"}),new Date(e.due_date).toLocaleDateString("pt-PT",{day:"2-digit",month:"short"})]})]})]}),(0,a.jsx)("button",{onClick:()=>X(e.id),className:"btn btn-ghost btn-icon-sm opacity-0 group-hover:opacity-100 shrink-0",style:{color:"var(--error)"},children:(0,a.jsx)(o.A,{className:"w-3.5 h-3.5"})})]})})]},e.id)})})]},t.id)})})]})}},65229:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},71847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(12115);let s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...p}=e;return(0,a.createElement)("svg",{ref:t,...n,width:l,height:l,stroke:r,strokeWidth:o?24*Number(i)/Number(l):i,className:s("lucide",c),...p},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let r=(0,a.forwardRef)((r,n)=>{let{className:i,...o}=r;return(0,a.createElement)(l,{ref:n,iconNode:t,className:s("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),i),...o})});return r.displayName="".concat(e),r}},85342:(e,t,r)=>{Promise.resolve().then(r.bind(r,45635))}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=85342)),_N_E=e.O()}]);