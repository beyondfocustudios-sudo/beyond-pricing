(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4382],{26041:(e,a,l)=>{"use strict";l.d(a,{BU:()=>n,V:()=>r,dx:()=>c,iJ:()=>t,qd:()=>i,vj:()=>s});let s=[{value:"crew",label:"Equipa (Crew)",color:"#1a8fa3"},{value:"equipamento",label:"Equipamento",color:"#8b6b56"},{value:"pos_producao",label:"P\xf3s-Produ\xe7\xe3o",color:"#7c3aed"},{value:"despesas",label:"Despesas",color:"#d97706"},{value:"outro",label:"Outro",color:"#5a6280"}],t=[{value:"continental_23",label:"Continental (23%)",rate:23},{value:"madeira_22",label:"Madeira (22%)",rate:22},{value:"acores_16",label:"A\xe7ores (16%)",rate:16},{value:"isento",label:"Isento / Art. 53.\xba (0%)",rate:0}];function r(e){var a,l;return null!=(l=null==(a=t.find(a=>a.value===e))?void 0:a.rate)?l:23}let n=[{value:"rascunho",label:"Rascunho",badge:"badge-default"},{value:"enviado",label:"Enviado",badge:"badge-accent"},{value:"aprovado",label:"Aprovado",badge:"badge-success"},{value:"cancelado",label:"Cancelado",badge:"badge-error"},{value:"arquivado",label:"Arquivado",badge:"badge-warning"}],i=[{value:"pre_producao",label:"Pr\xe9-Produ\xe7\xe3o",color:"#1a8fa3"},{value:"rodagem",label:"Rodagem",color:"#d97706"},{value:"pos_producao",label:"P\xf3s-Produ\xe7\xe3o",color:"#7c3aed"}],c={iva_regime:"continental_23",overhead_pct:15,contingencia_pct:10,margem_alvo_pct:30,margem_minima_pct:15,investimento_pct:0,moeda:"EUR"}},62890:(e,a,l)=>{"use strict";l.d(a,{U:()=>t});var s=l(55417);function t(){return(0,s.createBrowserClient)("https://wjzcutnjnzxylzqysneg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndqemN1dG5qbnp4eWx6cXlzbmVnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzMjYzMjcsImV4cCI6MjA4NjkwMjMyN30.bku3F43nks_Uq22Ag-viZZpMQfrw43eq3sahNChbBq8")}},89091:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>v});var s=l(95155),t=l(12115),r=l(26497),n=l(69434),i=l(62890),c=l(26041),d=l(6191),o=l(65229),u=l(46046),m=l(18514),h=l(71360);let b=["dia","hora","unidade","verba","km","semana","m\xeas"],x={category:"crew",name:"",unit:"dia",base_rate:"",min_rate:"",notes:""};function v(){let[e,a]=(0,t.useState)([]),[l,v]=(0,t.useState)(!0),[p,j]=(0,t.useState)(!1),[g,N]=(0,t.useState)(null),[f,y]=(0,t.useState)(x),[_,C]=(0,t.useState)(!1),[w,k]=(0,t.useState)(""),I=(0,t.useCallback)(async()=>{v(!0);let e=(0,i.U)(),{data:l}=await e.from("rates").select("*").order("category").order("name");a(null!=l?l:[]),v(!1)},[]);(0,t.useEffect)(()=>{I()},[I]);let A=()=>{N(null),y(x),j(!0)},q=async()=>{let e;C(!0);let a=(0,i.U)(),l={category:f.category,name:f.name.trim(),unit:f.unit,base_rate:parseFloat(f.base_rate)||0,min_rate:parseFloat(f.min_rate)||0,notes:f.notes.trim()||null};if(g?{error:e}=await a.from("rates").update(l).eq("id",g):{error:e}=await a.from("rates").insert(l),C(!1),e)return void alert(e.message);j(!1),I()},E=async e=>{if(!confirm("Apagar esta tarifa?"))return;let a=(0,i.U)();await a.from("rates").delete().eq("id",e),I()},S=w?e.filter(e=>e.category===w):e;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"page-header",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"page-title",children:"Tarifas"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Valores base por categoria e unidade"})]}),(0,s.jsxs)("button",{onClick:A,className:"btn btn-primary",children:[(0,s.jsx)(d.A,{className:"h-4 w-4"}),"Nova Tarifa"]})]}),(0,s.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,s.jsx)("button",{onClick:()=>k(""),className:"badge ".concat(""===w?"badge-accent":"badge-default"," cursor-pointer"),children:"Todas"}),c.vj.map(e=>(0,s.jsx)("button",{onClick:()=>k(e.value),className:"badge ".concat(w===e.value?"badge-accent":"badge-default"," cursor-pointer"),children:e.label},e.value))]}),(0,s.jsx)(r.N,{children:p&&(0,s.jsx)(n.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:(0,s.jsxs)("div",{className:"card space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-base font-semibold",style:{color:"var(--text)"},children:g?"Editar Tarifa":"Nova Tarifa"}),(0,s.jsx)("button",{onClick:()=>j(!1),className:"btn btn-ghost btn-icon-sm",children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Categoria"}),(0,s.jsx)("select",{value:f.category,onChange:e=>y({...f,category:e.target.value}),className:"input",children:c.vj.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Nome"}),(0,s.jsx)("input",{value:f.name,onChange:e=>y({...f,name:e.target.value}),placeholder:"Ex: Realizador",className:"input",autoFocus:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Unidade"}),(0,s.jsx)("select",{value:f.unit,onChange:e=>y({...f,unit:e.target.value}),className:"input",children:b.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Tarifa Base (€)"}),(0,s.jsx)("input",{type:"number",step:"0.01",value:f.base_rate,onChange:e=>y({...f,base_rate:e.target.value}),placeholder:"0.00",className:"input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Tarifa M\xednima (€)"}),(0,s.jsx)("input",{type:"number",step:"0.01",value:f.min_rate,onChange:e=>y({...f,min_rate:e.target.value}),placeholder:"0.00",className:"input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"label",children:"Notas"}),(0,s.jsx)("input",{value:f.notes,onChange:e=>y({...f,notes:e.target.value}),placeholder:"Opcional",className:"input"})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>j(!1),className:"btn btn-secondary",children:"Cancelar"}),(0,s.jsxs)("button",{onClick:q,disabled:_||!f.name.trim(),className:"btn btn-primary",children:[(0,s.jsx)(u.A,{className:"h-4 w-4"}),_?"A guardar…":"Guardar"]})]})]})})}),l?(0,s.jsx)("div",{className:"space-y-2",children:Array.from({length:4}).map((e,a)=>(0,s.jsx)("div",{className:"skeleton h-12 rounded-xl"},a))}):0===S.length?(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("p",{className:"empty-title",children:"Sem tarifas"}),(0,s.jsx)("p",{className:"empty-desc",children:"Cria a primeira tarifa para usar nos or\xe7amentos"}),(0,s.jsxs)("button",{onClick:A,className:"btn btn-primary btn-sm",children:[(0,s.jsx)(d.A,{className:"h-3.5 w-3.5"}),"Nova Tarifa"]})]})}):(0,s.jsx)("div",{className:"table-wrap",children:(0,s.jsxs)("table",{className:"data-table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Categoria"}),(0,s.jsx)("th",{children:"Nome"}),(0,s.jsx)("th",{children:"Unidade"}),(0,s.jsx)("th",{className:"text-right",children:"Base (€)"}),(0,s.jsx)("th",{className:"text-right",children:"M\xedn. (€)"}),(0,s.jsx)("th",{className:"hidden md:table-cell",children:"Notas"}),(0,s.jsx)("th",{style:{width:"80px"}})]})}),(0,s.jsx)("tbody",{children:S.map(e=>{var a,l,t;let r=c.vj.find(a=>a.value===e.category);return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"badge badge-default",style:{borderColor:"transparent",background:"".concat(null!=(a=null==r?void 0:r.color)?a:"#5a6280","20"),color:null!=(l=null==r?void 0:r.color)?l:"var(--text-2)"},children:null!=(t=null==r?void 0:r.label)?t:e.category})}),(0,s.jsx)("td",{className:"font-medium",children:e.name}),(0,s.jsx)("td",{style:{color:"var(--text-2)"},children:e.unit}),(0,s.jsx)("td",{className:"text-right font-medium",children:Number(e.base_rate).toFixed(2)}),(0,s.jsx)("td",{className:"text-right",style:{color:"var(--text-2)"},children:Number(e.min_rate).toFixed(2)}),(0,s.jsx)("td",{className:"hidden md:table-cell",style:{color:"var(--text-3)",maxWidth:"200px"},children:(0,s.jsx)("span",{className:"truncate block",children:e.notes||"—"})}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)("button",{onClick:()=>{var a;N(e.id),y({category:e.category,name:e.name,unit:e.unit,base_rate:String(e.base_rate),min_rate:String(e.min_rate),notes:null!=(a=e.notes)?a:""}),j(!0)},className:"btn btn-ghost btn-icon-sm",children:(0,s.jsx)(m.A,{className:"h-3.5 w-3.5"})}),(0,s.jsx)("button",{onClick:()=>E(e.id),className:"btn btn-ghost btn-icon-sm",style:{color:"var(--error)"},children:(0,s.jsx)(h.A,{className:"h-3.5 w-3.5"})})]})})]},e.id)})})]})})]})}},93557:(e,a,l)=>{Promise.resolve().then(l.bind(l,89091))}},e=>{e.O(0,[5417,6028,8606,8441,1255,7358],()=>e(e.s=93557)),_N_E=e.O()}]);