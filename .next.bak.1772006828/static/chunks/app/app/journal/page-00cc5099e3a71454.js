(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2482],{6191:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},9263:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var s=a(95155),r=a(12115),l=a(47937),n=a(6191),c=a(65229),i=a(18098),o=a(39142),d=a(95740),u=a(39867),m=a(12108),x=a(24033),h=a(93014);let p=[{value:"great",emoji:"\uD83D\uDE04",label:"\xd3timo"},{value:"good",emoji:"\uD83D\uDE0A",label:"Bom"},{value:"neutral",emoji:"\uD83D\uDE10",label:"Normal"},{value:"bad",emoji:"\uD83D\uDE1E",label:"Mau"},{value:"terrible",emoji:"\uD83D\uDE22",label:"P\xe9ssimo"}],y={great:"\uD83D\uDE04",good:"\uD83D\uDE0A",neutral:"\uD83D\uDE10",bad:"\uD83D\uDE1E",terrible:"\uD83D\uDE22"};function v(){let e=(0,h.d)(),[t,a]=(0,r.useState)([]),[v,b]=(0,r.useState)(!0),[j,f]=(0,r.useState)(null),[k,g]=(0,r.useState)(!1),[N,w]=(0,r.useState)(null),[A,C]=(0,r.useState)(""),[S,M]=(0,r.useState)(""),[R,z]=(0,r.useState)(null),[E,T]=(0,r.useState)(""),[P,L]=(0,r.useState)(!1),[O,_]=(0,r.useState)(!1),[B,q]=(0,r.useState)(!1),D=(0,r.useRef)(null),[U,W]=(0,r.useState)(!1),[I,V]=(0,r.useState)(null);(0,r.useEffect)(()=>{var e;q(!!(null!=(e=window.SpeechRecognition)?e:window.webkitSpeechRecognition))},[]);let F=(0,r.useCallback)(async()=>{b(!0),f(null);try{let s=await fetch("/api/journal");if(s.ok){var t;let e=await s.json();a(null!=(t=e.entries)?t:[])}else{let t="Erro ao carregar entradas do journal";f(t),e.error(t)}}catch(a){let t="Sem liga\xe7\xe3o — n\xe3o foi poss\xedvel carregar o journal";f(t),e.error(t)}finally{b(!1)}},[e]);(0,r.useEffect)(()=>{F()},[F]);let H=async()=>{if(A.trim()&&S.trim()){L(!0);try{let a=E.split(",").map(e=>e.trim()).filter(Boolean),s=await fetch("/api/journal",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:A,body:S,mood:R,tags:a})});if(!s.ok){var t;let a=await s.json().catch(()=>({}));e.error(null!=(t=a.error)?t:"Erro ao guardar entrada");return}e.success("Entrada guardada"),C(""),M(""),z(null),T(""),V(null),g(!1),await F()}catch(t){e.error("Sem liga\xe7\xe3o — entrada n\xe3o guardada")}finally{L(!1)}}},J=async()=>{if(S.trim()){W(!0);try{let t=await fetch("/api/journal/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({body:S})});if(t.ok){var e;let a=await t.json();V(null!=(e=a.summary)?e:"")}}finally{W(!1)}}},X=e=>{let t=new Blob(["md"===e?"# ".concat(A,"\n\n").concat(S):"".concat(A,"\n").concat("=".repeat(A.length),"\n\n").concat(S)],{type:"text/plain"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download="journal-".concat(Date.now(),".").concat(e),s.click(),URL.revokeObjectURL(a)};return(0,s.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(l.A,{className:"h-6 w-6",style:{color:"var(--accent)"}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-bold",style:{color:"var(--text)"},children:"Journal"}),(0,s.jsx)("p",{className:"text-sm",style:{color:"var(--text-3)"},children:"As tuas notas e reflex\xf5es"})]})]}),(0,s.jsxs)("button",{className:"btn btn-primary btn-sm",onClick:()=>g(!k),children:[(0,s.jsx)(n.A,{className:"h-4 w-4"}),"Nova entrada"]})]}),k&&(0,s.jsxs)("div",{className:"card-glass rounded-xl p-5 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"font-semibold",style:{color:"var(--text)"},children:"Nova entrada"}),(0,s.jsx)("button",{className:"btn btn-ghost btn-icon-sm",onClick:()=>g(!1),children:(0,s.jsx)(c.A,{className:"h-4 w-4"})})]}),(0,s.jsx)("input",{className:"input w-full",placeholder:"T\xedtulo...",value:A,onChange:e=>C(e.target.value)}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("textarea",{className:"input w-full min-h-[160px] resize-y",placeholder:"Escreve aqui...",value:S,onChange:e=>M(e.target.value)}),B&&(0,s.jsxs)("button",{className:"absolute bottom-3 right-3 btn btn-sm ".concat(O?"btn-primary":"btn-secondary"),onClick:()=>{var e,t;let a=null!=(e=window.SpeechRecognition)?e:window.webkitSpeechRecognition;if(!a)return;if(O){null==(t=D.current)||t.stop(),_(!1);return}let s=new a;s.continuous=!0,s.interimResults=!1,s.lang="pt-PT",s.onresult=e=>{let t=Array.from(e.results).map(e=>e[0].transcript).join(" ");M(e=>e?e+" "+t:t)},s.onerror=()=>_(!1),s.start(),D.current=s,_(!0)},title:O?"Parar ditado":"Iniciar ditado por voz",children:[O?(0,s.jsx)(i.A,{className:"h-3.5 w-3.5"}):(0,s.jsx)(o.A,{className:"h-3.5 w-3.5"}),O?"Parar":"Voz"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-xs font-medium",style:{color:"var(--text-2)"},children:"Humor"}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap",children:p.map(e=>(0,s.jsxs)("button",{onClick:()=>z(R===e.value?null:e.value),className:"px-3 py-1.5 rounded-lg text-sm transition-all ".concat(R===e.value?"ring-2":""),style:{background:R===e.value?"var(--accent)":"var(--surface-2)",color:"var(--text)"},title:e.label,children:[e.emoji," ",e.label]},e.value))})]}),(0,s.jsx)("input",{className:"input w-full",placeholder:"Tags (separadas por v\xedrgula)...",value:E,onChange:e=>T(e.target.value)}),I&&(0,s.jsxs)("div",{className:"rounded-lg p-3 text-sm",style:{background:"var(--accent-subtle)",color:"var(--text-2)",border:"1px solid var(--accent)"},children:[(0,s.jsx)("p",{className:"font-medium mb-1",style:{color:"var(--accent)"},children:"Resumo IA"}),I]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,s.jsx)("button",{className:"btn btn-primary btn-sm",onClick:H,disabled:P||!A.trim()||!S.trim(),children:P?"A guardar…":"Guardar"}),(0,s.jsxs)("button",{className:"btn btn-secondary btn-sm",onClick:J,disabled:U||!S.trim(),children:[(0,s.jsx)(d.A,{className:"h-3.5 w-3.5"}),U?"A resumir…":"Resumir com IA"]}),(0,s.jsxs)("button",{className:"btn btn-ghost btn-sm",onClick:()=>X("txt"),disabled:!S.trim(),children:[(0,s.jsx)(u.A,{className:"h-3.5 w-3.5"})," .txt"]}),(0,s.jsxs)("button",{className:"btn btn-ghost btn-sm",onClick:()=>X("md"),disabled:!S.trim(),children:[(0,s.jsx)(u.A,{className:"h-3.5 w-3.5"})," .md"]})]})]}),v?(0,s.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,s.jsx)("div",{className:"card-glass rounded-xl p-4 animate-pulse h-20",style:{background:"var(--surface)"}},e))}):j?(0,s.jsxs)("div",{className:"card-glass rounded-xl p-10 text-center space-y-3",children:[(0,s.jsx)("p",{style:{color:"var(--text-2)"},children:j}),(0,s.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:F,children:"Tentar novamente"})]}):0===t.length?(0,s.jsxs)("div",{className:"card-glass rounded-xl p-10 text-center space-y-2",children:[(0,s.jsx)(l.A,{className:"h-10 w-10 mx-auto",style:{color:"var(--text-3)"}}),(0,s.jsx)("p",{style:{color:"var(--text-2)"},children:"Sem entradas ainda"}),(0,s.jsx)("p",{className:"text-sm",style:{color:"var(--text-3)"},children:"Come\xe7a por escrever a tua primeira nota"})]}):(0,s.jsx)("div",{className:"space-y-3",children:t.map(e=>{let t=N===e.id;return(0,s.jsxs)("div",{className:"card-glass rounded-xl p-4 space-y-2 cursor-pointer",onClick:()=>w(t?null:e.id),children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[e.mood&&(0,s.jsx)("span",{className:"text-lg shrink-0",children:y[e.mood]}),(0,s.jsx)("p",{className:"font-semibold truncate",style:{color:"var(--text)"},children:e.title})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,s.jsx)("span",{className:"text-xs",style:{color:"var(--text-3)"},children:new Date(e.created_at).toLocaleDateString("pt-PT")}),t?(0,s.jsx)(m.A,{className:"h-4 w-4",style:{color:"var(--text-3)"}}):(0,s.jsx)(x.A,{className:"h-4 w-4",style:{color:"var(--text-3)"}})]})]}),(0,s.jsx)("p",{className:"text-sm",style:{color:"var(--text-2)"},children:t?e.body:e.body.slice(0,100)+(e.body.length>100?"…":"")}),e.tags.length>0&&(0,s.jsx)("div",{className:"flex gap-1.5 flex-wrap",children:e.tags.map(e=>(0,s.jsxs)("span",{className:"px-2 py-0.5 rounded-full text-xs",style:{background:"var(--surface-2)",color:"var(--text-3)"},children:["#",e]},e))})]},e.id)})})]})}},12108:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},18098:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]])},23327:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},24033:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},35521:(e,t,a)=>{Promise.resolve().then(a.bind(a,9263))},39142:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]])},39867:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},47937:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},61362:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},65229:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},71847:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(12115);let r=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:n=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:o="",children:d,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:t,...l,width:n,height:n,stroke:a,strokeWidth:i?24*Number(c)/Number(n):c,className:r("lucide",o),...m},[...u.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let a=(0,s.forwardRef)((a,l)=>{let{className:c,...i}=a;return(0,s.createElement)(n,{ref:l,iconNode:t,className:r("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),c),...i})});return a.displayName="".concat(e),a}},78874:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},93014:(e,t,a)=>{"use strict";a.d(t,{ToastProvider:()=>x,d:()=>d});var s=a(95155),r=a(12115),l=a(61362),n=a(78874),c=a(23327),i=a(65229);let o=(0,r.createContext)(null);function d(){let e=(0,r.useContext)(o);if(!e)throw Error("useToast must be used inside <ToastProvider>");return e}let u={success:(0,s.jsx)(l.A,{className:"h-4 w-4 shrink-0",style:{color:"#22c55e"}}),error:(0,s.jsx)(n.A,{className:"h-4 w-4 shrink-0",style:{color:"#ef4444"}}),info:(0,s.jsx)(c.A,{className:"h-4 w-4 shrink-0",style:{color:"var(--accent)"}})},m={success:"rgba(34,197,94,0.3)",error:"rgba(239,68,68,0.3)",info:"rgba(26,143,163,0.3)"};function x(e){let{children:t}=e,[a,l]=(0,r.useState)([]),n=(0,r.useRef)({}),c=(0,r.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e)),n.current[e]&&(clearTimeout(n.current[e]),delete n.current[e])},[]),d=(0,r.useCallback)((e,t)=>{let a=Math.random().toString(36).slice(2);l(s=>[...s.slice(-4),{id:a,type:e,message:t}]),n.current[a]=setTimeout(()=>c(a),3500)},[c]),x=(0,r.useMemo)(()=>({success:e=>d("success",e),error:e=>d("error",e),info:e=>d("info",e)}),[d]);return(0,s.jsxs)(o.Provider,{value:x,children:[t,(0,s.jsx)("div",{"aria-live":"polite",className:"fixed bottom-5 right-4 z-[9999] flex flex-col gap-2 items-end pointer-events-none",style:{maxWidth:"min(380px, calc(100vw - 2rem))"},children:a.map(e=>(0,s.jsxs)("div",{role:"alert",className:"pointer-events-auto flex items-start gap-3 rounded-xl px-4 py-3 text-sm shadow-lg animate-toast-in",style:{background:"var(--surface-3)",border:"1px solid ".concat(m[e.type]),backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",color:"var(--text)",minWidth:"240px"},children:[u[e.type],(0,s.jsx)("p",{className:"flex-1 leading-snug",style:{color:"var(--text)"},children:e.message}),(0,s.jsx)("button",{onClick:()=>c(e.id),className:"shrink-0 mt-0.5 opacity-50 hover:opacity-100 transition-opacity","aria-label":"Fechar",children:(0,s.jsx)(i.A,{className:"h-3.5 w-3.5"})})]},e.id))}),(0,s.jsx)("style",{children:"\n        @keyframes toast-in {\n          from { opacity: 0; transform: translateY(8px) scale(0.96); }\n          to   { opacity: 1; transform: translateY(0) scale(1); }\n        }\n        .animate-toast-in { animation: toast-in 0.18s ease-out forwards; }\n      "})]})}},95740:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])}},e=>{e.O(0,[8441,1255,7358],()=>e(e.s=35521)),_N_E=e.O()}]);