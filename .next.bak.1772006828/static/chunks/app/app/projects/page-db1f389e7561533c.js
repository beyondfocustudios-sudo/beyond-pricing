(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8905],{4874:(e,a,t)=>{"use strict";t.d(a,{HI:()=>i,HY:()=>o,Pm:()=>c,XC:()=>d,Y3:()=>n,bm:()=>r});var s=t(12115),l=t(41407);let r={page:{duration:.26,ease:"easeOut"},micro:{type:"spring",stiffness:380,damping:32,mass:.6},smooth:{duration:.22,ease:"easeOut"}},i={page:{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8}},tab:{initial:{opacity:0,x:12},animate:{opacity:1,x:0},exit:{opacity:0,x:-12}},listItem:{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8}},fadeIn:{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}};function c(){return!(0,l.I)()}function n(){let e=c(),[a,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=window.matchMedia("(min-width: 1024px) and (hover: hover) and (pointer: fine)"),a=()=>t(e.matches);return a(),e.addEventListener("change",a),()=>e.removeEventListener("change",a)},[]),e&&a}function o(e){var a,t;return e.enabled?{whileHover:{y:null!=(a=e.hoverY)?a:-1.5},whileTap:{scale:null!=(t=e.tapScale)?t:.98},transition:r.micro}:{}}function d(e){return e?{whileHover:{y:-4,scale:1.004},transition:r.micro}:{}}},6191:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(71847).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},10383:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(71847).A)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])},14006:(e,a,t)=>{Promise.resolve().then(t.bind(t,62662))},23327:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(71847).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},26041:(e,a,t)=>{"use strict";t.d(a,{BU:()=>i,V:()=>r,dx:()=>n,iJ:()=>l,qd:()=>c,vj:()=>s});let s=[{value:"crew",label:"Equipa (Crew)",color:"#1a8fa3"},{value:"equipamento",label:"Equipamento",color:"#8b6b56"},{value:"pos_producao",label:"P\xf3s-Produ\xe7\xe3o",color:"#7c3aed"},{value:"despesas",label:"Despesas",color:"#d97706"},{value:"outro",label:"Outro",color:"#5a6280"}],l=[{value:"continental_23",label:"Continental (23%)",rate:23},{value:"madeira_22",label:"Madeira (22%)",rate:22},{value:"acores_16",label:"A\xe7ores (16%)",rate:16},{value:"isento",label:"Isento / Art. 53.\xba (0%)",rate:0}];function r(e){var a,t;return null!=(t=null==(a=l.find(a=>a.value===e))?void 0:a.rate)?t:23}let i=[{value:"rascunho",label:"Rascunho",badge:"badge-default"},{value:"enviado",label:"Enviado",badge:"badge-accent"},{value:"aprovado",label:"Aprovado",badge:"badge-success"},{value:"cancelado",label:"Cancelado",badge:"badge-error"},{value:"arquivado",label:"Arquivado",badge:"badge-warning"}],c=[{value:"pre_producao",label:"Pr\xe9-Produ\xe7\xe3o",color:"#1a8fa3"},{value:"rodagem",label:"Rodagem",color:"#d97706"},{value:"pos_producao",label:"P\xf3s-Produ\xe7\xe3o",color:"#7c3aed"}],n={iva_regime:"continental_23",overhead_pct:15,contingencia_pct:10,margem_alvo_pct:30,margem_minima_pct:15,investimento_pct:0,moeda:"EUR"}},41407:(e,a,t)=>{"use strict";t.d(a,{I:()=>i});var s=t(40031),l=t(15824),r=t(12115);function i(){s.r.current||(0,l.Uu)();let[e]=(0,r.useState)(s.O.current);return e}},61362:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(71847).A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},62662:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>h});var s=t(95155),l=t(12115),r=t(52619),i=t.n(r),c=t(69434),n=t(62890),o=t(64269),d=t(26041),m=t(6191),p=t(86651),u=t(93014),x=t(91040);function h(){let[e,a]=(0,l.useState)([]),[t,r]=(0,l.useState)(!0),[h,y]=(0,l.useState)(null),[v,f]=(0,l.useState)(""),[b,g]=(0,l.useState)(""),[j,N]=(0,l.useState)(1),k=(0,u.d)(),w=(0,l.useCallback)(async()=>{r(!0),y(null);let e=(0,n.U)(),{data:t,error:s}=await e.from("projects").select("id, project_name, client_name, status, created_at, calc").is("deleted_at",null).order("created_at",{ascending:!1});s&&(k.error("Erro ao carregar projetos: ".concat(s.message)),y(s.message)),a(null!=t?t:[]),r(!1)},[k]);(0,l.useEffect)(()=>{w()},[w]);let C=(0,l.useMemo)(()=>e.filter(e=>{var a;let t=!v||e.project_name.toLowerCase().includes(v.toLowerCase())||(null!=(a=e.client_name)?a:"").toLowerCase().includes(v.toLowerCase()),s=!b||e.status===b;return t&&s}),[e,v,b]),A=Math.max(1,Math.ceil(C.length/12)),_=Math.min(j,A),M=(_-1)*12,S=C.slice(M,M+12);return(0,l.useEffect)(()=>{N(1)},[v,b]),(0,l.useEffect)(()=>{j>A&&N(A)},[j,A]),(0,s.jsxs)("div",{className:"space-y-6 pb-8",children:[(0,s.jsx)("section",{className:"surface p-6 md:p-8",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-[0.1em]",style:{color:"var(--muted)"},children:"Projects"}),(0,s.jsx)("h1",{className:"mt-2 page-title",children:"Projetos"}),(0,s.jsx)("p",{className:"page-subtitle",children:"Cards grandes, filtros em pills e pagina\xe7\xe3o limpa."})]}),(0,s.jsxs)(i(),{href:"/app/projects/new",className:"btn btn-primary",children:[(0,s.jsx)(m.A,{className:"h-4 w-4"}),"Novo Projeto"]})]})}),(0,s.jsx)("section",{className:"card p-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center",children:[(0,s.jsxs)("div",{className:"relative min-w-0 flex-1",children:[(0,s.jsx)(p.A,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2",style:{color:"var(--text-3)"}}),(0,s.jsx)(x.O3,{value:v,onChange:e=>f(e.target.value),placeholder:"Pesquisar por projeto ou cliente",className:"w-full py-2.5 pl-9 pr-3 text-sm"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>g(""),className:"pill ".concat(""===b?"pill-active":""),children:"Todos"}),d.BU.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>g(e.value),className:"pill ".concat(b===e.value?"pill-active":""),children:e.label},e.value))]})]})}),t?(0,s.jsx)("section",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-3",children:Array.from({length:6}).map((e,a)=>(0,s.jsx)(x.u4,{className:"h-40"},a))}):h?(0,s.jsx)("section",{className:"card",children:(0,s.jsx)(x.pp,{title:"Erro ao carregar projetos",description:h,action:(0,s.jsx)(x.KF,{onClick:w,className:"px-4 py-2 text-xs",children:"Tentar novamente"})})}):0===S.length?(0,s.jsx)("section",{className:"card",children:(0,s.jsx)(x.pp,{title:v||b?"Nenhum resultado":"Sem projetos",description:v||b?"Ajusta os filtros para encontrar projetos.":"Cria o primeiro or\xe7amento para iniciar a opera\xe7\xe3o."})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("section",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 xl:grid-cols-3",children:S.map((e,a)=>{var t,l;let r=d.BU.find(a=>a.value===e.status),n=null!=(l=null==(t=e.calc)?void 0:t.preco_recomendado)?l:0;return(0,s.jsx)(c.P.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.24,delay:.04*a},children:(0,s.jsxs)(i(),{href:"/app/projects/".concat(e.id),className:"card card-hover block p-5",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-start justify-between gap-2",children:[(0,s.jsx)("span",{className:"inline-flex h-11 w-11 items-center justify-center rounded-full text-sm font-semibold",style:{background:"rgba(26, 143, 163, 0.14)",border:"1px solid rgba(26, 143, 163, 0.3)",color:"var(--accent-primary)"},children:e.project_name.slice(0,1).toUpperCase()}),r?(0,s.jsx)(x.ab,{className:"text-[0.7rem]",children:r.label}):null]}),(0,s.jsx)("h2",{className:"line-clamp-1 text-base font-semibold",style:{color:"var(--text)"},children:e.project_name}),(0,s.jsx)("p",{className:"mt-1 line-clamp-1 text-xs",style:{color:"var(--text-3)"},children:e.client_name||"Sem cliente"}),(0,s.jsxs)("div",{className:"mt-5 flex items-end justify-between gap-3",children:[(0,s.jsx)("p",{className:"text-xs",style:{color:"var(--text-3)"},children:(0,o.kz)(e.created_at)}),(0,s.jsx)("p",{className:"text-sm font-semibold",style:{color:"var(--text)"},children:n>0?(0,o.SS)(n):"Sem c\xe1lculo"})]})]})},e.id)})}),(0,s.jsxs)("section",{className:"card flex flex-wrap items-center justify-between gap-3 px-4 py-3",children:[(0,s.jsxs)("p",{className:"text-xs",style:{color:"var(--text-3)"},children:[C.length," projetos \xb7 p\xe1gina ",_," de ",A]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.KF,{onClick:()=>N(e=>Math.max(1,e-1)),disabled:_<=1,className:"px-3 py-2 text-xs",children:"Anterior"}),(0,s.jsx)(x.KF,{onClick:()=>N(e=>Math.min(A,e+1)),disabled:_>=A,className:"px-3 py-2 text-xs",children:"Seguinte"})]})]})]})]})}},62890:(e,a,t)=>{"use strict";t.d(a,{U:()=>l});var s=t(55417);function l(){return(0,s.createBrowserClient)("https://wjzcutnjnzxylzqysneg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndqemN1dG5qbnp4eWx6cXlzbmVnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzMjYzMjcsImV4cCI6MjA4NjkwMjMyN30.bku3F43nks_Uq22Ag-viZZpMQfrw43eq3sahNChbBq8")}},64269:(e,a,t)=>{"use strict";t.d(a,{$C:()=>o,SS:()=>c,Sc:()=>i,Yv:()=>n,cn:()=>r,kz:()=>d});var s=t(2821),l=t(75889);function r(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,l.QP)((0,s.$)(a))}function i(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toLocaleString("pt-PT",{minimumFractionDigits:a,maximumFractionDigits:a})}function c(e){return e.toLocaleString("pt-PT",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2})}function n(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function o(){return Math.random().toString(36).slice(2,9)}function d(e){return new Date(e).toLocaleDateString("pt-PT")}},65229:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(71847).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},78874:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(71847).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},79051:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(71847).A)("Clock3",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16.5 12",key:"1aq6pp"}]])},86651:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(71847).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},91040:(e,a,t)=>{"use strict";t.d(a,{A:()=>x,KF:()=>p,O3:()=>u,ab:()=>m,do:()=>h,pp:()=>y,u4:()=>v});var s=t(95155),l=t(69434),r=t(41407),i=t(10383),c=t(79051),n=t(86651),o=t(64269),d=t(4874);function m(e){let{className:a,children:t,active:r=!1}=e,i=(0,d.Y3)();return(0,s.jsx)(l.P.span,{className:(0,o.cn)("pill",r&&"pill-active",a),...i?{whileHover:{y:-1},transition:d.bm.smooth}:{},children:t})}function p(e){let{className:a,children:t,variant:r="secondary",...i}=e,c=(0,d.Pm)();return(0,s.jsx)(l.P.button,{className:(0,o.cn)("pill-btn","primary"===r?"pill-btn-primary":"pill-btn-secondary",a),...(0,d.HY)({enabled:c}),...i,children:t})}function u(e){let{className:a,...t}=e;return(0,s.jsx)("input",{className:(0,o.cn)("pill-input",a),...t})}function x(e){let{className:a,avatars:t=[]}=e,n=(0,r.I)(),m=new Date().toLocaleDateString("pt-PT",{weekday:"long",day:"2-digit",month:"long"});return(0,s.jsx)(l.P.div,{initial:!n&&"initial",animate:n?void 0:"animate",variants:{initial:{opacity:0,y:-8},animate:{opacity:1,y:0}},transition:d.bm.page,className:(0,o.cn)("top-schedule-bar p-4 md:p-5",a),children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3 md:gap-5",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,s.jsx)("span",{className:"icon-btn","aria-hidden":!0,children:(0,s.jsx)(i.A,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase tracking-[0.08em]",style:{color:"var(--muted)"},children:"Schedule"}),(0,s.jsx)("p",{className:"text-sm font-semibold capitalize",style:{color:"var(--text)"},children:m})]})]}),(0,s.jsx)("div",{className:"flex flex-1 flex-wrap items-center gap-2",children:["09:00","11:30","14:00","16:30"].map(e=>(0,s.jsxs)("span",{className:"pill inline-flex items-center gap-1.5",children:[(0,s.jsx)(c.A,{className:"h-3.5 w-3.5"}),e]},e))}),(0,s.jsx)("div",{className:"flex items-center",children:t.length>0?(0,s.jsx)("div",{className:"-space-x-2",children:t.slice(0,4).map(e=>(0,s.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full border text-xs font-semibold",style:{background:"var(--surface-2)",borderColor:"var(--border-soft)",color:"var(--text)"},children:e.trim().slice(0,1).toUpperCase()},e))}):(0,s.jsx)("span",{className:"pill",children:"Sem equipa atribuida"})})]})})}function h(e){let{className:a,title:t,action:r,children:i}=e,c=(0,d.Y3)();return(0,s.jsxs)(l.P.section,{className:(0,o.cn)("chart-card card-hover",a),...(0,d.XC)(c),children:[(0,s.jsxs)("header",{className:"mb-4 flex items-center justify-between gap-3",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold",style:{color:"var(--text)"},children:t}),r]}),i]})}function y(e){let{className:a,title:t,description:l,action:r}=e;return(0,s.jsxs)("div",{className:(0,o.cn)("empty-state empty-state-premium",a),children:[(0,s.jsx)(n.A,{className:"empty-icon"}),(0,s.jsx)("p",{className:"empty-title",children:t}),l?(0,s.jsx)("p",{className:"empty-desc",children:l}):null,r]})}function v(e){let{className:a}=e;return(0,s.jsx)(l.P.div,{initial:{opacity:.65},animate:{opacity:1},transition:{duration:.45,ease:"easeOut"},className:(0,o.cn)("skeleton-card h-28",a)})}},93014:(e,a,t)=>{"use strict";t.d(a,{ToastProvider:()=>u,d:()=>d});var s=t(95155),l=t(12115),r=t(61362),i=t(78874),c=t(23327),n=t(65229);let o=(0,l.createContext)(null);function d(){let e=(0,l.useContext)(o);if(!e)throw Error("useToast must be used inside <ToastProvider>");return e}let m={success:(0,s.jsx)(r.A,{className:"h-4 w-4 shrink-0",style:{color:"#22c55e"}}),error:(0,s.jsx)(i.A,{className:"h-4 w-4 shrink-0",style:{color:"#ef4444"}}),info:(0,s.jsx)(c.A,{className:"h-4 w-4 shrink-0",style:{color:"var(--accent)"}})},p={success:"rgba(34,197,94,0.3)",error:"rgba(239,68,68,0.3)",info:"rgba(26,143,163,0.3)"};function u(e){let{children:a}=e,[t,r]=(0,l.useState)([]),i=(0,l.useRef)({}),c=(0,l.useCallback)(e=>{r(a=>a.filter(a=>a.id!==e)),i.current[e]&&(clearTimeout(i.current[e]),delete i.current[e])},[]),d=(0,l.useCallback)((e,a)=>{let t=Math.random().toString(36).slice(2);r(s=>[...s.slice(-4),{id:t,type:e,message:a}]),i.current[t]=setTimeout(()=>c(t),3500)},[c]),u=(0,l.useMemo)(()=>({success:e=>d("success",e),error:e=>d("error",e),info:e=>d("info",e)}),[d]);return(0,s.jsxs)(o.Provider,{value:u,children:[a,(0,s.jsx)("div",{"aria-live":"polite",className:"fixed bottom-5 right-4 z-[9999] flex flex-col gap-2 items-end pointer-events-none",style:{maxWidth:"min(380px, calc(100vw - 2rem))"},children:t.map(e=>(0,s.jsxs)("div",{role:"alert",className:"pointer-events-auto flex items-start gap-3 rounded-xl px-4 py-3 text-sm shadow-lg animate-toast-in",style:{background:"var(--surface-3)",border:"1px solid ".concat(p[e.type]),backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",color:"var(--text)",minWidth:"240px"},children:[m[e.type],(0,s.jsx)("p",{className:"flex-1 leading-snug",style:{color:"var(--text)"},children:e.message}),(0,s.jsx)("button",{onClick:()=>c(e.id),className:"shrink-0 mt-0.5 opacity-50 hover:opacity-100 transition-opacity","aria-label":"Fechar",children:(0,s.jsx)(n.A,{className:"h-3.5 w-3.5"})})]},e.id))}),(0,s.jsx)("style",{children:"\n        @keyframes toast-in {\n          from { opacity: 0; transform: translateY(8px) scale(0.96); }\n          to   { opacity: 1; transform: translateY(0) scale(1); }\n        }\n        .animate-toast-in { animation: toast-in 0.18s ease-out forwards; }\n      "})]})}}},e=>{e.O(0,[5417,6028,4909,2619,8441,1255,7358],()=>e(e.s=14006)),_N_E=e.O()}]);