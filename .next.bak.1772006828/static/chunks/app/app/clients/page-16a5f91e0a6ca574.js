(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6489],{13716:(e,s,t)=>{Promise.resolve().then(t.bind(t,28720))},28720:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var a=t(95155),l=t(12115),r=t(62890),c=t(26497),n=t(69434),i=t(64269),o=t(93014),d=t(35299),m=t(99708),x=t(6191),u=t(19408),p=t(75426),h=t(58734),j=t(91169),v=t(20508),b=t(23664),y=t(17910),N=t(65229),f=t(5917);function g(){let[e,s]=(0,l.useState)([]),[t,g]=(0,l.useState)(!0),[w,C]=(0,l.useState)(null),[k,_]=(0,l.useState)(null),[S,A]=(0,l.useState)(!1),[z,I]=(0,l.useState)(null),[P,E]=(0,l.useState)(!1),F=(0,o.d)(),[T,U]=(0,l.useState)(""),[M,D]=(0,l.useState)(""),[O,q]=(0,l.useState)(""),[J,Y]=(0,l.useState)("client_viewer"),[L,B]=(0,l.useState)(""),[V,Z]=(0,l.useState)("client_viewer"),[R,W]=(0,l.useState)(null),[X,G]=(0,l.useState)(null),[Q,$]=(0,l.useState)(!1),[K,H]=(0,l.useState)(null),[ee,es]=(0,l.useState)([]),[et,ea]=(0,l.useState)(""),[el,er]=(0,l.useState)([]),[ec,en]=(0,l.useState)(""),[ei,eo]=(0,l.useState)([]),ed=(0,l.useCallback)(async()=>{C(null);let e=(0,r.U)(),t=await fetch("/api/admin/org-role");if(t.ok){let e=await t.json();I(e.role),A(e.isAdmin)}else C("N\xe3o foi poss\xedvel validar permiss\xf5es da organiza\xe7\xe3o.");E(!0);let{data:a,error:l}=await e.from("clients").select("id, name, slug, created_at").order("created_at",{ascending:!1});if(l){F.error("Erro ao carregar clientes: ".concat(l.message)),C(l.message),g(!1);return}s(await Promise.all((null!=a?a:[]).map(async s=>{let{count:t}=await e.from("projects").select("id",{count:"exact",head:!0}).eq("client_id",s.id),{count:a}=await e.from("client_users").select("id",{count:"exact",head:!0}).eq("client_id",s.id);return{...s,_projectCount:null!=t?t:0,_memberCount:null!=a?a:0}})));let{data:c}=await e.from("projects").select("id, project_name, client_id, status").is("deleted_at",null).order("project_name");eo(null!=c?c:[]),g(!1)},[F]);(0,l.useEffect)(()=>{ed()},[ed]);let em=async()=>{if(!T.trim()||Q)return;$(!0);let e=(0,r.U)(),s=(0,i.Yv)(T),{error:t}=await e.from("clients").insert({name:T.trim(),slug:s});if($(!1),t)return void F.error("Erro ao criar cliente: ".concat(t.message));F.success('Cliente "'.concat(T.trim(),'" criado')),U(""),_(null),ed()},ex=async()=>{var e,s;if((null==k?void 0:k.type)!=="create_user"||!M.trim()||!O||Q)return;$(!0);let t=await fetch("/api/admin/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:M.trim(),password:O,clientId:k.clientId,role:J})}),a=await t.json();if($(!1),!t.ok)return void F.error(null!=(e=a.error)?e:"Erro ao criar utilizador");let l=null!=(s=a.password)?s:O;H("Utilizador criado! Password: ".concat(l)),F.success("Utilizador criado com sucesso"),D(""),q(""),ed()},eu=async()=>{var e,s;if((null==k?void 0:k.type)!=="invite_client"||!L.trim()||Q)return;$(!0);let t=await fetch("/api/clients/invites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientId:k.clientId,email:L.trim(),role:V,expiresInDays:7})}),a=await t.json();if($(!1),!t.ok||!a.inviteUrl)return void F.error(null!=(e=a.error)?e:"Erro ao gerar convite");W(a.inviteUrl),G(null!=(s=a.expiresAt)?s:null),F.success("Link de convite criado"),ed()},ep=async()=>{if((null==k?void 0:k.type)!=="assign_project"||!et||Q)return;$(!0);let e=(0,r.U)(),{error:s}=await e.from("projects").update({client_id:k.clientId}).eq("id",et);if($(!1),s)return void F.error("Erro ao associar projeto: ".concat(s.message));F.success("Projeto associado ao cliente"),ea(""),_(null),ed()},eh=async e=>{let s=(0,r.U)(),{data:t,error:a}=await s.from("client_users").select("id, user_id, role").eq("client_id",e);a&&F.error("Erro ao carregar membros: ".concat(a.message)),er(null!=t?t:[])},ej=async e=>{if(!ec||Q)return;$(!0);let s=(0,r.U)(),{error:t}=await s.from("project_members").upsert({project_id:ec,user_id:e,role:"client_viewer"},{onConflict:"project_id,user_id"});if($(!1),t)return void F.error("Erro ao conceder acesso: ".concat(t.message));F.success("Acesso concedido ao projeto")},ev=e=>{navigator.clipboard.writeText(e).then(()=>F.success("Copiado")).catch(()=>F.error("N\xe3o foi poss\xedvel copiar"))};return t?(0,a.jsx)("div",{className:"min-h-[60vh] flex items-center justify-center",children:(0,a.jsx)(d.A,{className:"w-6 h-6 animate-spin",style:{color:"var(--text-3)"}})}):w?(0,a.jsxs)("div",{className:"min-h-[60vh] flex flex-col items-center justify-center gap-4 text-center p-8",children:[(0,a.jsx)("p",{className:"text-lg font-semibold",style:{color:"var(--text)"},children:"Erro ao carregar clientes"}),(0,a.jsx)("p",{className:"text-sm",style:{color:"var(--text-2)"},children:w}),(0,a.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:ed,children:"Tentar novamente"})]}):P&&!S?(0,a.jsxs)("div",{className:"min-h-[60vh] flex flex-col items-center justify-center gap-4 text-center p-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center",style:{background:"var(--surface-2)",border:"1px solid var(--border)"},children:(0,a.jsx)(m.A,{className:"w-7 h-7",style:{color:"var(--text-3)"}})}),(0,a.jsx)("h2",{className:"text-xl font-bold",style:{color:"var(--text)"},children:"Acesso Restrito"}),(0,a.jsxs)("p",{className:"text-sm max-w-sm",style:{color:"var(--text-2)"},children:["Precisas de ser ",(0,a.jsx)("strong",{style:{color:"var(--text)"},children:"owner"})," ou"," ",(0,a.jsx)("strong",{style:{color:"var(--text)"},children:"admin"})," da organiza\xe7\xe3o Beyond Focus para gerir clientes."]}),(0,a.jsxs)("p",{className:"text-xs",style:{color:"var(--text-3)"},children:["O teu role atual:"," ",(0,a.jsx)("code",{className:"px-2 py-0.5 rounded text-xs",style:{background:"var(--surface-2)",color:"var(--text-2)"},children:null!=z?z:"sem role"})]}),(0,a.jsxs)("p",{className:"text-xs",style:{color:"var(--text-3)"},children:["Pede ao owner para correr"," ",(0,a.jsx)("code",{className:"px-1 rounded text-xs",style:{background:"var(--surface-2)",color:"var(--text-2)"},children:"/api/admin/bootstrap"})," ","ou para te adicionar em team_members."]})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"page-header",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"page-title",children:"Clientes"}),(0,a.jsxs)("p",{className:"page-subtitle",children:[0===e.length?"Nenhum cliente ainda":"".concat(e.length," cliente").concat(1!==e.length?"s":""),z&&(0,a.jsxs)("span",{style:{color:"var(--text-3)"},children:[" \xb7 ",z]})]})]}),S&&(0,a.jsxs)("button",{onClick:()=>{_({type:"create_client"}),H(null)},className:"btn btn-primary",children:[(0,a.jsx)(x.A,{className:"w-4 h-4"}),"Novo Cliente"]})]}),0===e.length&&(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"empty-state",children:[(0,a.jsx)(u.A,{className:"empty-icon"}),(0,a.jsx)("p",{className:"empty-title",children:"Nenhum cliente ainda"}),(0,a.jsx)("p",{className:"empty-desc",children:"Cria o primeiro cliente para come\xe7ar a partilhar projetos."}),S&&(0,a.jsxs)("button",{onClick:()=>{_({type:"create_client"}),H(null)},className:"btn btn-primary btn-sm",children:[(0,a.jsx)(x.A,{className:"w-4 h-4"}),"Criar 1\xba Cliente"]})]})}),(0,a.jsx)("div",{className:"grid gap-4 sm:grid-cols-2",children:e.map(e=>(0,a.jsxs)("div",{className:"card card-hover",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"var(--accent-dim)",border:"1px solid var(--border)"},children:(0,a.jsx)(u.A,{className:"w-5 h-5",style:{color:"var(--accent-2)"}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-sm",style:{color:"var(--text)"},children:e.name}),(0,a.jsxs)("p",{className:"text-xs",style:{color:"var(--text-3)"},children:["/",e.slug]})]})]}),(0,a.jsx)("button",{onClick:()=>ev(e.slug),className:"btn btn-ghost btn-icon-sm",title:"Copiar slug",children:(0,a.jsx)(p.A,{className:"w-3.5 h-3.5"})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-xs mb-4",style:{color:"var(--text-3)"},children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(h.A,{className:"w-3 h-3"}),e._projectCount," projeto",1!==e._projectCount?"s":""]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(j.A,{className:"w-3 h-3"}),e._memberCount," utilizador",1!==e._memberCount?"es":""]})]}),S&&(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)("button",{onClick:()=>{_({type:"create_user",clientId:e.id,clientName:e.name}),H(null)},className:"btn btn-secondary btn-sm text-xs",children:[(0,a.jsx)(v.A,{className:"w-3.5 h-3.5"})," Convidar utilizador"]}),(0,a.jsxs)("button",{onClick:()=>{_({type:"invite_client",clientId:e.id,clientName:e.name}),B(""),Z("client_viewer"),W(null),G(null),H(null)},className:"btn btn-secondary btn-sm text-xs",children:[(0,a.jsx)(b.A,{className:"w-3.5 h-3.5"})," Convidar cliente"]}),(0,a.jsxs)("button",{onClick:()=>{es(ei.filter(e=>!e.client_id)),_({type:"assign_project",clientId:e.id,clientName:e.name}),H(null)},className:"btn btn-secondary btn-sm text-xs",children:[(0,a.jsx)(h.A,{className:"w-3.5 h-3.5"})," Associar projeto"]}),(0,a.jsxs)("button",{onClick:async()=>{await eh(e.id),_({type:"members",clientId:e.id,clientName:e.name}),H(null)},className:"btn btn-secondary btn-sm text-xs",children:[(0,a.jsx)(y.A,{className:"w-3.5 h-3.5"})," Membros"]})]})]},e.id))}),(0,a.jsx)(c.N,{children:k&&(0,a.jsx)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center p-4",style:{background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)"},onClick:e=>{e.target===e.currentTarget&&_(null)},children:(0,a.jsxs)(n.P.div,{initial:{y:24,opacity:0},animate:{y:0,opacity:1},exit:{y:24,opacity:0},className:"modal-content w-full max-w-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,a.jsxs)("h2",{className:"font-semibold",style:{color:"var(--text)"},children:["create_client"===k.type&&"Novo Cliente","create_user"===k.type&&"Convidar para ".concat(k.clientName),"invite_client"===k.type&&"Convidar cliente para ".concat(k.clientName),"assign_project"===k.type&&"Associar Projeto a ".concat(k.clientName),"members"===k.type&&"Membros de ".concat(k.clientName)]}),(0,a.jsx)("button",{onClick:()=>_(null),className:"btn btn-ghost btn-icon-sm",children:(0,a.jsx)(N.A,{className:"w-5 h-5"})})]}),"create_client"===k.type&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("input",{autoFocus:!0,value:T,onChange:e=>U(e.target.value),onKeyDown:e=>"Enter"===e.key&&em(),placeholder:"Nome do cliente",className:"input w-full"}),T&&(0,a.jsxs)("p",{className:"text-xs",style:{color:"var(--text-3)"},children:["Slug:"," ",(0,a.jsxs)("code",{style:{color:"var(--text-2)"},children:["/",(0,i.Yv)(T)]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>_(null),className:"btn btn-secondary flex-1",children:"Cancelar"}),(0,a.jsx)("button",{onClick:em,disabled:Q||!T.trim(),className:"btn btn-primary flex-1",children:Q?"A criar…":"Criar cliente"})]})]}),"create_user"===k.type&&(0,a.jsx)("div",{className:"space-y-3",children:K?(0,a.jsxs)("div",{className:"rounded-xl p-4",style:{background:"var(--success-bg)",border:"1px solid var(--success-border)"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",style:{color:"var(--success)"},children:[(0,a.jsx)(f.A,{className:"w-4 h-4"})," Utilizador criado!"]}),(0,a.jsx)("p",{className:"text-xs font-mono break-all",style:{color:"var(--text-2)"},children:K}),(0,a.jsxs)("button",{onClick:()=>ev(K),className:"btn btn-ghost btn-sm text-xs mt-2",style:{color:"var(--text-3)"},children:[(0,a.jsx)(p.A,{className:"w-3 h-3"})," Copiar"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Email"}),(0,a.jsx)("input",{type:"email",value:M,onChange:e=>D(e.target.value),placeholder:"email@cliente.com",className:"input w-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Password tempor\xe1ria"}),(0,a.jsx)("input",{type:"password",value:O,onChange:e=>q(e.target.value),placeholder:"M\xednimo 6 caracteres",className:"input w-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Fun\xe7\xe3o"}),(0,a.jsxs)("select",{value:J,onChange:e=>Y(e.target.value),className:"input w-full",children:[(0,a.jsx)("option",{value:"client_viewer",children:"Visualizador"}),(0,a.jsx)("option",{value:"client_approver",children:"Aprovador"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>_(null),className:"btn btn-secondary flex-1",children:"Cancelar"}),(0,a.jsx)("button",{onClick:ex,disabled:Q||!M.trim()||!O,className:"btn btn-primary flex-1",children:Q?"A criar…":"Criar utilizador"})]})]})}),"invite_client"===k.type&&(0,a.jsx)("div",{className:"space-y-3",children:R?(0,a.jsxs)("div",{className:"rounded-xl p-4",style:{background:"var(--success-bg)",border:"1px solid var(--success-border)"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",style:{color:"var(--success)"},children:[(0,a.jsx)(f.A,{className:"w-4 h-4"})," Convite criado!"]}),(0,a.jsx)("p",{className:"text-xs break-all",style:{color:"var(--text-2)"},children:R}),(0,a.jsxs)("p",{className:"text-xs mt-1",style:{color:"var(--text-3)"},children:["Expira: ",X?new Date(X).toLocaleDateString("pt-PT"):"7 dias"]}),(0,a.jsxs)("button",{onClick:()=>ev(R),className:"btn btn-ghost btn-sm text-xs mt-2",style:{color:"var(--text-3)"},children:[(0,a.jsx)(p.A,{className:"w-3 h-3"})," Copiar link"]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Email do cliente"}),(0,a.jsx)("input",{type:"email",value:L,onChange:e=>B(e.target.value),placeholder:"email@cliente.com",className:"input w-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Fun\xe7\xe3o"}),(0,a.jsxs)("select",{value:V,onChange:e=>Z(e.target.value),className:"input w-full",children:[(0,a.jsx)("option",{value:"client_viewer",children:"Visualizador"}),(0,a.jsx)("option",{value:"client_approver",children:"Aprovador"})]})]}),(0,a.jsx)("p",{className:"text-xs",style:{color:"var(--text-3)"},children:"O convite expira em 7 dias e \xe9 single-use."}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>_(null),className:"btn btn-secondary flex-1",children:"Cancelar"}),(0,a.jsx)("button",{onClick:eu,disabled:Q||!L.trim(),className:"btn btn-primary flex-1",children:Q?"A criar…":"Gerar link"})]})]})}),"assign_project"===k.type&&(0,a.jsx)("div",{className:"space-y-3",children:0===ee.length?(0,a.jsxs)("div",{className:"empty-state py-8",children:[(0,a.jsx)(h.A,{className:"empty-icon"}),(0,a.jsx)("p",{className:"empty-desc",children:"Sem projetos por associar."}),(0,a.jsx)("p",{className:"text-xs mt-1",style:{color:"var(--text-3)"},children:"Todos os projetos j\xe1 t\xeam cliente associado, ou n\xe3o h\xe1 projetos."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Projeto"}),(0,a.jsxs)("select",{value:et,onChange:e=>ea(e.target.value),className:"input w-full",children:[(0,a.jsx)("option",{value:"",children:"Selecionar projeto…"}),ee.map(e=>(0,a.jsx)("option",{value:e.id,children:e.project_name},e.id))]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>_(null),className:"btn btn-secondary flex-1",children:"Cancelar"}),(0,a.jsx)("button",{onClick:ep,disabled:Q||!et,className:"btn btn-primary flex-1",children:Q?"A associar…":"Associar"})]})]})}),"members"===k.type&&(0,a.jsxs)("div",{className:"space-y-3",children:[0===el.length?(0,a.jsxs)("div",{className:"empty-state py-8",children:[(0,a.jsx)(j.A,{className:"empty-icon"}),(0,a.jsx)("p",{className:"empty-desc",children:"Sem membros ainda."})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"label",children:"Conceder acesso a projeto"}),(0,a.jsxs)("select",{value:ec,onChange:e=>en(e.target.value),className:"input w-full",children:[(0,a.jsx)("option",{value:"",children:"Selecionar projeto…"}),ei.map(e=>(0,a.jsx)("option",{value:e.id,children:e.project_name},e.id))]})]}),el.map(e=>{var s;return(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-xl px-4 py-3",style:{background:"var(--surface-2)",border:"1px solid var(--border)"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(v.A,{className:"w-4 h-4",style:{color:"var(--text-3)"}}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm",style:{color:"var(--text)"},children:null!=(s=e.email)?s:e.user_id.slice(0,12)+"…"}),(0,a.jsx)("p",{className:"text-xs",style:{color:"var(--text-3)"},children:e.role})]})]}),ec&&(0,a.jsx)("button",{onClick:()=>ej(e.user_id),disabled:Q,className:"btn btn-primary btn-sm text-xs",children:Q?"…":"Dar acesso"})]},e.id)})]}),(0,a.jsx)("button",{onClick:()=>_(null),className:"btn btn-secondary w-full",children:"Fechar"})]})]})})})]})}},62890:(e,s,t)=>{"use strict";t.d(s,{U:()=>l});var a=t(55417);function l(){return(0,a.createBrowserClient)("https://wjzcutnjnzxylzqysneg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndqemN1dG5qbnp4eWx6cXlzbmVnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzEzMjYzMjcsImV4cCI6MjA4NjkwMjMyN30.bku3F43nks_Uq22Ag-viZZpMQfrw43eq3sahNChbBq8")}},64269:(e,s,t)=>{"use strict";t.d(s,{$C:()=>o,SS:()=>n,Sc:()=>c,Yv:()=>i,cn:()=>r,kz:()=>d});var a=t(2821),l=t(75889);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,l.QP)((0,a.$)(s))}function c(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toLocaleString("pt-PT",{minimumFractionDigits:s,maximumFractionDigits:s})}function n(e){return e.toLocaleString("pt-PT",{style:"currency",currency:"EUR",minimumFractionDigits:2,maximumFractionDigits:2})}function i(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function o(){return Math.random().toString(36).slice(2,9)}function d(e){return new Date(e).toLocaleDateString("pt-PT")}},93014:(e,s,t)=>{"use strict";t.d(s,{ToastProvider:()=>u,d:()=>d});var a=t(95155),l=t(12115),r=t(61362),c=t(78874),n=t(23327),i=t(65229);let o=(0,l.createContext)(null);function d(){let e=(0,l.useContext)(o);if(!e)throw Error("useToast must be used inside <ToastProvider>");return e}let m={success:(0,a.jsx)(r.A,{className:"h-4 w-4 shrink-0",style:{color:"#22c55e"}}),error:(0,a.jsx)(c.A,{className:"h-4 w-4 shrink-0",style:{color:"#ef4444"}}),info:(0,a.jsx)(n.A,{className:"h-4 w-4 shrink-0",style:{color:"var(--accent)"}})},x={success:"rgba(34,197,94,0.3)",error:"rgba(239,68,68,0.3)",info:"rgba(26,143,163,0.3)"};function u(e){let{children:s}=e,[t,r]=(0,l.useState)([]),c=(0,l.useRef)({}),n=(0,l.useCallback)(e=>{r(s=>s.filter(s=>s.id!==e)),c.current[e]&&(clearTimeout(c.current[e]),delete c.current[e])},[]),d=(0,l.useCallback)((e,s)=>{let t=Math.random().toString(36).slice(2);r(a=>[...a.slice(-4),{id:t,type:e,message:s}]),c.current[t]=setTimeout(()=>n(t),3500)},[n]),u=(0,l.useMemo)(()=>({success:e=>d("success",e),error:e=>d("error",e),info:e=>d("info",e)}),[d]);return(0,a.jsxs)(o.Provider,{value:u,children:[s,(0,a.jsx)("div",{"aria-live":"polite",className:"fixed bottom-5 right-4 z-[9999] flex flex-col gap-2 items-end pointer-events-none",style:{maxWidth:"min(380px, calc(100vw - 2rem))"},children:t.map(e=>(0,a.jsxs)("div",{role:"alert",className:"pointer-events-auto flex items-start gap-3 rounded-xl px-4 py-3 text-sm shadow-lg animate-toast-in",style:{background:"var(--surface-3)",border:"1px solid ".concat(x[e.type]),backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)",color:"var(--text)",minWidth:"240px"},children:[m[e.type],(0,a.jsx)("p",{className:"flex-1 leading-snug",style:{color:"var(--text)"},children:e.message}),(0,a.jsx)("button",{onClick:()=>n(e.id),className:"shrink-0 mt-0.5 opacity-50 hover:opacity-100 transition-opacity","aria-label":"Fechar",children:(0,a.jsx)(i.A,{className:"h-3.5 w-3.5"})})]},e.id))}),(0,a.jsx)("style",{children:"\n        @keyframes toast-in {\n          from { opacity: 0; transform: translateY(8px) scale(0.96); }\n          to   { opacity: 1; transform: translateY(0) scale(1); }\n        }\n        .animate-toast-in { animation: toast-in 0.18s ease-out forwards; }\n      "})]})}}},e=>{e.O(0,[5417,6028,4909,7006,8441,1255,7358],()=>e(e.s=13716)),_N_E=e.O()}]);