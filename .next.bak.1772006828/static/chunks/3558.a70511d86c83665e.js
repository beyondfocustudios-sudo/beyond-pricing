"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3558],{3558:(e,t,o)=>{o.d(t,{generateCsv:()=>x,generatePdf:()=>f});var a=o(63394),n=o(26041);let i=e=>e.toLocaleString("pt-PT",{minimumFractionDigits:2,maximumFractionDigits:2}),c=e=>"".concat(i(e)," €"),r=e=>{var t,o;return null!=(o=null==(t=n.vj.find(t=>t.value===e))?void 0:t.label)?o:e},l=(0,a.rgb)(.102,.561,.639),d=(0,a.rgb)(.031,.043,.063),g=(0,a.rgb)(.42,.46,.52),p=(0,a.rgb)(.88,.9,.92),m=(0,a.rgb)(.18,.2,.24),s=(0,a.rgb)(1,1,1),u=(0,a.rgb)(.09,.11,.16);function y(e,t){e.y-t<e.margin+40&&function(e){let t=e.doc.addPage([e.pageW,e.pageH]);e.pages.push(t),e.page=t,e.y=e.pageH-e.margin}(e)}function _(e,t,o,a,n,i){let c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:m;e.page.drawText(t,{x:o,y:a,size:n,font:i,color:c})}function v(e,t,o,a,n){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:m,c=n.widthOfTextAtSize(t,a);_(e,t,e.pageW-e.margin-c,o,a,n,i)}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;e.page.drawLine({start:{x:e.margin,y:e.y},end:{x:e.pageW-e.margin,y:e.y},thickness:.5,color:(0,a.rgb)(.85,.87,.9),opacity:t>1?1:t})}async function f(e){var t,o,f,x,w;let b=await a.PDFDocument.create(),P=await b.embedFont(a.StandardFonts.Helvetica),F=await b.embedFont(a.StandardFonts.HelveticaBold),C={doc:b,font:P,bold:F,pages:[],page:b.addPage([595.28,841.89]),y:789.89,margin:52,pageW:595.28,pageH:841.89,contentW:491.28};C.pages.push(C.page);let D=null!=(t=e.inputs)?t:{itens:[],overhead_pct:0,contingencia_pct:0,margem_alvo_pct:0,margem_minima_pct:0,investimento_pct:0,iva_regime:"continental_23"},S=e.calc;if(C.page.drawRectangle({x:0,y:761.89,width:595.28,height:80,color:d}),C.page.drawRectangle({x:0,y:761.89,width:4,height:80,color:l}),_(C,"BEYOND PRICING",52,809.89,16,F,s),_(C,"Proposta de Or\xe7amento",52,789.89,9,P,(0,a.rgb)(.6,.7,.75)),v(C,D.data_projeto?new Date(D.data_projeto).toLocaleDateString("pt-PT"):new Date().toLocaleDateString("pt-PT"),799.89,8,P,(0,a.rgb)(.6,.7,.75)),C.y=737.89,_(C,e.project_name,52,C.y,14,F,m),C.y-=16,e.client_name&&(_(C,"Cliente: ".concat(e.client_name),52,C.y,9,P,g),C.y-=14),D.cidade||D.localidade){let e=[D.cidade,D.localidade,D.pais].filter(Boolean).join(", ");_(C,"Local: ".concat(e),52,C.y,9,P,g),C.y-=14}D.descricao&&(C.y-=4,_(C,D.descricao,52,C.y,8,P,g),C.y-=14),C.y-=8,h(C,1),C.y-=20;let I=null!=(o=D.itens)?o:[];for(let e of n.vj.filter(e=>I.some(t=>t.categoria===e.value))){let t=I.filter(t=>t.categoria===e.value),o=t.reduce((e,t)=>e+t.quantidade*t.preco_unitario,0);y(C,24+14*t.length+18),C.page.drawRectangle({x:50,y:C.y-5,width:495.28,height:18,color:u}),_(C,r(e.value).toUpperCase(),56,C.y+1,7.5,F,l),v(C,c(o),C.y+1,8,F,l),C.y-=20;for(let e of(_(C,"Descri\xe7\xe3o",56,C.y,7,F,g),_(C,"Unid.",252,C.y,7,F,g),_(C,"Qtd.",332,C.y,7,F,g),_(C,"P.Unit.",392,C.y,7,F,g),v(C,"Total",C.y,7,F,g),C.y-=4,h(C,.5),C.y-=10,t)){y(C,14);let t=e.quantidade*e.preco_unitario;_(C,e.nome.length>38?e.nome.slice(0,36)+"…":e.nome,56,C.y,8,P,m),_(C,e.unidade,252,C.y,8,P,g),_(C,String(e.quantidade),332,C.y,8,P,m),_(C,i(e.preco_unitario),392,C.y,8,P,m),v(C,c(t),C.y,8,P,m),C.y-=13}C.y-=10}y(C,200),C.y-=6,h(C,1),C.y-=22,_(C,"RESUMO FINANCEIRO",52,C.y,11,F,l),C.y-=22;let A=n.iJ.find(e=>e.value===D.iva_regime),j=null!=(f=null==A?void 0:A.rate)?f:23;for(let[e,t,o]of[["Custo Direto",c(S.custo_direto)],["Overhead (".concat(D.overhead_pct,"%)"),c(S.overhead_valor)],["Conting\xeancia (".concat(D.contingencia_pct,"%)"),c(S.contingencia_valor)],...S.investimento_valor>0?[["Investimento Equip. (".concat(D.investimento_pct,"%)"),c(S.investimento_valor)]]:[],["Subtotal (s/ IVA)",c(S.preco_recomendado),!0],["".concat(j>0?"IVA (".concat(j,"%)"):"IVA (Isento)"),c(S.iva_valor)]])y(C,16),_(C,e,58,C.y,9,o?F:P,m),v(C,t,C.y,9,o?F:P,m),C.y-=16;C.y-=6,h(C,1),C.y-=20,C.page.drawRectangle({x:52,y:C.y-8,width:491.28,height:28,color:(0,a.rgb)(.04,.08,.1)}),C.page.drawRectangle({x:52,y:C.y-8,width:3,height:28,color:l}),_(C,"Pre\xe7o Recomendado  (margem ".concat(D.margem_alvo_pct,"%)"),62,C.y+4,9,F,(0,a.rgb)(.7,.9,.95)),v(C,c(null!=(x=S.preco_recomendado_com_iva)?x:S.preco_recomendado),C.y+4,11,F,s),C.y-=36,_(C,"Pre\xe7o M\xednimo (margem ".concat(D.margem_minima_pct,"%)"),58,C.y,9,P,g),v(C,c(null!=(w=S.preco_minimo_com_iva)?w:S.preco_minimo),C.y,9,F,m),C.y-=28;let R=S.preco_recomendado>0?(S.margem_alvo_valor/S.preco_recomendado*100).toFixed(1):"0.0";if(_(C,"Margem l\xedquida: ".concat(R,"% \xb7 Alvo: ").concat(D.margem_alvo_pct,"%"),58,C.y,8,P,g),C.y-=20,D.observacoes||D.condicoes)for(let[e,t]of(y(C,80),h(C,1),C.y-=18,[["Observa\xe7\xf5es",D.observacoes],["Condi\xe7\xf5es Comerciais",D.condicoes]])){if(!t)continue;y(C,40),_(C,e,52,C.y,9,F,m),C.y-=14;let o=t.split(" "),a="";for(let e of o){let t=a?"".concat(a," ").concat(e):e;P.widthOfTextAtSize(t,8)>483.28?(y(C,14),_(C,a,58,C.y,8,P,g),C.y-=12,a=e):a=t}a&&(y(C,14),_(C,a,58,C.y,8,P,g),C.y-=12),C.y-=8}let T=C.doc.getPages();for(let e=0;e<T.length;e++){let t=T[e];t.drawLine({start:{x:52,y:38},end:{x:543.28,y:38},thickness:.5,color:p});let o="Beyond Pricing  \xb7  P\xe1gina ".concat(e+1," de ").concat(T.length),a=P.widthOfTextAtSize(o,7);t.drawText(o,{x:(595.28-a)/2,y:26,size:7,font:P,color:g})}return b.save()}function x(e){var t,o,a,i;let c=e.inputs,l=e.calc,d=[];for(let a of(d.push(["# Beyond Pricing — Exporta\xe7\xe3o CSV"]),d.push(["Projeto",e.project_name]),d.push(["Cliente",null!=(t=e.client_name)?t:""]),d.push(["Data",new Date().toLocaleDateString("pt-PT")]),d.push([]),d.push(["Categoria","Descri\xe7\xe3o","Unidade","Quantidade","Pre\xe7o Unit. (€)","Total (€)"]),n.vj)){let e=(null!=(o=c.itens)?o:[]).filter(e=>e.categoria===a.value);if(0!==e.length)for(let t of e)d.push([r(a.value),t.nome,t.unidade,String(t.quantidade),t.preco_unitario.toFixed(2),(t.quantidade*t.preco_unitario).toFixed(2)])}return d.push([]),d.push(["# Resumo"]),d.push(["Custo Direto (€)",l.custo_direto.toFixed(2)]),d.push(["Overhead (".concat(c.overhead_pct,"%) (€)"),l.overhead_valor.toFixed(2)]),d.push(["Conting\xeancia (".concat(c.contingencia_pct,"%) (€)"),l.contingencia_valor.toFixed(2)]),l.investimento_valor>0&&d.push(["Investimento (".concat(c.investimento_pct,"%) (€)"),l.investimento_valor.toFixed(2)]),d.push(["Subtotal s/ IVA (€)",l.preco_recomendado.toFixed(2)]),d.push(["IVA (€)",l.iva_valor.toFixed(2)]),d.push(["Pre\xe7o Recomendado c/ IVA (€)",(null!=(a=l.preco_recomendado_com_iva)?a:l.preco_recomendado).toFixed(2)]),d.push(["Pre\xe7o M\xednimo c/ IVA (€)",(null!=(i=l.preco_minimo_com_iva)?i:l.preco_minimo).toFixed(2)]),d.map(e=>e.map(e=>'"'.concat(String(e).replace(/"/g,'""'),'"')).join(",")).join("\n")}}}]);